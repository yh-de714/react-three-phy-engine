import{Texture as e,LinearFilter as t,DataTexture as n,RGBAFormat as a,Points as i,InstancedBufferGeometry as r,BufferGeometry as o,Vector3 as s,Vector4 as l,Quaternion as c,Euler as d,NormalBlending as u,AdditiveBlending as p,InterleavedBuffer as h,InterleavedBufferAttribute as f,BufferAttribute as g,InstancedInterleavedBuffer as m,DynamicDrawUsage as b,Sphere as k,ShaderMaterial as v,DoubleSide as y,FrontSide as x,MultiplyBlending as w,SubtractiveBlending as S}from"three";const T={getColor(e){let t=e.toString();t=t.substring(t.lastIndexOf(".")+1);let n,a=[255,255,255];switch(t){case"grass":a=[.223,.827,.325],n=[.741,.498,.258];break;case"dirt":a=[.741,.498,.258];break;case"leaves":a=[.152,.682,.376];break;case"sand":a=[.878,.819,.686];break;case"ice":a=[.65,.882,.96];break;case"stone":a=[.537,.64,.65];break;case"cobblestone":a=[.666,.647,.588];break;case"wood":a=[.603,.321,.152];break;case"snow":a=[.905,.976,1]}return n?[a[0],a[1],a[2],n[0],n[1],n[2]]:[a[0],a[1],a[2]]},fire:{type:"star",numParticles:20,position:[0,0,0],colors:[1,1,0,0,1,1,0,1,1,0,0,1,1,0,0,1,1,0,0,.5,0,0,0,0],lifeTime:2,timeRange:2,startSize:.3,endSize:.9,velocity:[0,.8,0],velocityRange:[.15,.15,.15],gravity:[0,-.2,0],spinSpeedRange:4},smoke:{position:[-2,-.2,0],colors:[0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0],numParticles:20,lifeTime:2,timeRange:2,startSize:.5,endSize:2,velocity:[0,1.6,0],velocityRange:[.2,0,.2],gravity:[0,-.25,0],spinSpeedRange:4,blending:"normal"},addBlock:{type:"cube",numParticles:30,lifeTime:1.5,endTime:1.5,startTime:0,startSize:.25,endSize:.5,sizeRange:.25,spinSpeedRange:2,radius:.25,velocity:[1,0,1],velocityRange:[.25,0,.25],acceleration:[1,0,1],accelerationRange:[.25,0,.25],gravity:[0,.05,0],tween:"outQuad",blending:"normal",alphaTest:.1},removeBlock:{type:"cube",lifeTime:1.5,endTime:1.5,startTime:0,startSize:.5,sizeRange:.25,endSize:.1,spinSpeedRange:2,accelerationRange:[.5,.5,.5],gravity:[0,-.1,0],tween:"outQuad",blending:"normal",alphaTest:.1},explosion:{colors:[1,0,0,0,1,0,0,1,1,0,0,1,1,1,0,1,1,1,1,.5,1,1,1,0],type:"cloud",radius:.5,radiusRange:.5,numParticles:400,positionRange:[2,1,2],lifeTime:3,endTime:4,lifeTimeRange:1,startTime:0,startSize:.1,endSize:2,sizeRange:1,accelerationRange:[1,.3,1],acceleration:[.8,.8,.8],gravity:[0,-.5,0],spinSpeedRange:2,luma:!1},playerMove:{trail:!0,colors:[1,1,1,1,.2,.2,.2,0],type:"round",blending:"normal",numParticles:4,maxParticles:1e3,positionRange:[.2,0,.2],lifeTime:1.5,startSize:.5,endSize:1,sizeRange:.25,velocityRange:[.6,0,.6],gravity:[0,.1,0]},vehicleMove:{trail:!0,colors:[.5,.5,.5,.25,.2,.2,.2,0],type:"round",blending:"normal",numParticles:4,maxParticles:2e3,positionRange:[.25,0,.25],lifeTime:1.5,startSize:.5,endSize:1,sizeRange:.25,velocityRange:[.6,0,.6],gravity:[0,.2,0]},vehicleTrack:{trail:!0,colors:[.2,.2,.2,.1,.2,.2,.2,0],type:"Round2",blending:"normal",startSize:.3,endSize:.3,numParticles:4,maxParticles:2e3,position:[0,-.1,0],lifeTime:6,oriented:!0},underWater:{trail:!0,colors:[1,1,1,1,.5,.5,1,0],type:"bubble",blending:"normal",numParticles:1,maxParticles:1e3,positionRange:[.25,0,.25],lifeTime:1.5,startSize:.1,endSize:.5,sizeRange:.05,velocity:[0,1,0],velocityRange:[1,0,1],acceleration:[.2,0,.2],gravity:[0,1,0]},bazookaFire:{trail:!0,colors:[1,0,0,1,1,1,0,.5,1,1,1,0],type:"round",numParticles:2,maxParticles:600,positionRange:[.1,.1,.1],lifeTime:1.5,startSize:.5,endSize:1,sizeRange:.1,velocityRange:[.6,.6,.6],gravity:[0,.1,0],luma:!1}};function L(){this.parent=null,this.position=[0,0,0],this.rotation=[0,0,0],this.name="default",this.type="round",this.tween="linear",this.trail=!1,this.model="",this.numParticles=1,this.maxParticles=0,this.numFrames=1,this.frameDuration=1,this.frameStart=0,this.frameStartRange=0,this.timeRange=99999999,this.startTime=null,this.lifeTime=1,this.endTime=-1,this.lifeTimeRange=0,this.sizeRange=0,this.startSize=1,this.startSizeRange=0,this.endSize=1,this.endSizeRange=0,this.pposition=[0,0,0],this.positionRange=[0,0,0],this.velocity=[0,0,0],this.velocityRange=[0,0,0],this.acceleration=[0,0,0],this.accelerationRange=[0,0,0],this.spinStart=0,this.spinStartRange=0,this.spinSpeed=0,this.spinSpeedRange=0,this.colorMult=[1,1,1,1],this.colorMultRange=[0,0,0,0],this.worldVelocity=[0,0,0],this.gravity=[0,0,0],this.oriented=!1,this.orientation=[0,0,0,1],this.colors=[1,1,1,1],this.blending="additive",this.radius=0,this.radiusRange=0,this.tmpRotation=null,this.alphaTest=0,this.renderOrder=0,this.luma=!0,this.depthWrite=!1,this.transparent=!0}const C={torad:Math.PI/180,todeg:180/Math.PI,random:()=>Math.random(),rand:(e,t)=>e+C.random()*(t-e),randInt:(e,t)=>e+Math.floor(C.random()*(t-e+1)),plusMinus:e=>(C.random()-.5)*e*2,plusMinusVector:e=>{const t=[];let n=e.length;for(;n--;)t.push(C.plusMinus(e[n]));return t},toTexture:n=>{let a=new e(n);return a.minFilter=t,a.magFilter=t,a.flipY=!1,a.needsUpdate=!0,a},createTextureFromFloats:(e,i,r,o)=>{let s=null;if(null==o){const o=new Uint8Array(r.length);let l;for(let e=0;e<r.length;e++)l=255*r[e],o[e]=l;return s=new n(o,e,i,a),s.minFilter=t,s.magFilter=t,s.needsUpdate=!0,s}return s=o,s}},A=function(e){let t;switch(e){case"linear":t="float tween( float k ) { return k; }";break;case"inQuad":t="float tween( float k ) { return k * k; }";break;case"outQuad":t="float tween( float k ) { return k * ( 2.0 - k ); }";break;case"inOutQuad":t="float tween( float k ) { \n\t\t\tif ( ( k *= 2.0 ) < 1.0 ) return 0.5 * k * k;\n            return - 0.5 * ( --k * ( k - 2.0 ) - 1.0 ); \n        }";break;case"inCubic":t="float tween( float k ) { return k * k * k; }";break;case"outCubic":t="float tween( float k ) { return --k * k * k + 1.0; }";break;case"inOutCubic":t="float tween( float k ) { \n\t\t\tif ( ( k *= 2.0 ) < 1.0 ) return 0.5 * k * k * k;\n\t\t\treturn 0.5 * ( ( k -= 2.0 ) * k * k + 2.0 ); \n        }";break;case"inQuart":t="float tween( float k ) { return k * k * k * k; }";break;case"outQuart":t="float tween( float k ) { return 1.0 - ( --k * k * k * k ); }";break;case"inOutQuart":t="float tween( float k ) { \n\t\t\tif ( ( k *= 2.0 ) < 1.0) return 0.5 * k * k * k * k;\n\t\t\treturn - 0.5 * ( ( k -= 2.0 ) * k * k * k - 2.0 ); \n        }";break;case"inQuint":t="float tween( float k ) { return k * k * k * k * k; }";break;case"outQuint":t="float tween( float k ) { return --k * k * k * k * k + 1.0; }";break;case"inOutQuint":t="float tween( float k ) { \n\t\t\tif ( ( k *= 2.0 ) < 1.0 ) return 0.5 * k * k * k * k * k;\n\t\t\treturn 0.5 * ( ( k -= 2.0 ) * k * k * k * k + 2.0 );\n        }";break;case"inSine":t="#define PI_90 1.570796326794896\n        float tween( float k ) { float j = k * PI_90; return 1.0 - cos( j ); }";break;case"outSine":t="#define PI_90 1.570796326794896\n\t\tfloat tween( float k ) { float j = k * PI_90; return sin( j ); }";break;case"inOutSine":t="#define M_PI 3.14159265358979323846\n\t\tfloat tween( float k ) { \n\t\t\tfloat j = k * M_PI; return 0.5 * (1.0-cos(j));\n        }";break;case"inExpo":t="float tween( float k ) { return k == 0.0 ? 0.0 : pow( 1024.0, k - 1.0 ); }";break;case"outExpo":t="float tween( float k ) { return k == 1.0 ? 1.0 : 1.0 - pow( 2.0, - 10.0 * k ); }";break;case"inOutExpo":t="float tween( float k ) { \n\t\t\tif ( k == 0.0 ) return 0.0;\n\t\t    if ( k == 1.0 ) return 1.0;\n\t\t    if ( ( k *= 2.0 ) < 1.0 ) return 0.5 * pow( 1024.0, k - 1.0 );\n\t\t    return 0.5 * ( - pow( 2.0, - 10.0 * ( k - 1.0 ) ) + 2.0 );\n        }";break;case"inCirc":t="float tween( float k ) { return 1.0 - sqrt( 1.0 - k * k ); }";break;case"outCirc":t="float tween( float k ) { return sqrt( 1.0 - ( --k * k ) ); }";break;case"inOutCirc":t="float tween( float k ) { \n\t\t\tif ( ( k *= 2.0 ) < 1.0) return - 0.5 * ( sqrt( 1.0 - k * k ) - 1.0 );\n\t\t\treturn 0.5 * ( sqrt( 1.0 - ( k -= 2.0 ) * k ) + 1.0 ); \n        }";break;case"inElastic":t="#define TWO_PI 6.28318530717958647692\n        float tween(float k) {\n\t\t    float s;\n\t\t    float a = 0.1;\n\t\t    float p = 0.4;\n\t\t    if ( k == 0.0 ) return 0.0;\n\t\t    if ( k == 1.0 ) return 1.0;\n\t\t    if ( a < 1.0 ) { a = 1.0; s = p * 0.25; }\n\t\t    else s = p * asin( 1.0 / a ) / TWO_PI;\n\t\t    return - ( a * pow( 2.0, 10.0 * ( k -= 1.0 ) ) * sin( ( k - s ) * TWO_PI / p ) );\n\t\t}";break;case"outElastic":t="#define TWO_PI 6.28318530717958647692\n\t\tfloat tween(float k) {\n\t\t    float s;\n\t\t    float a = 0.1; \n\t\t    float p = 0.4;\n\t\t    if ( k == 0.0 ) return 0.0;\n\t\t    if ( k == 1.0 ) return 1.0;\n\t\t    if ( a < 1.0 ) { a = 1.0; s = p * 0.25; }\n\t\t    else s = p * asin( 1.0 / a ) / TWO_PI;\n\t\t    return ( a * pow( 2.0, - 10.0 * k) * sin( ( k - s ) * TWO_PI / p ) + 1.0 );\n\t\t}";break;case"inOutElastic":t="#define TWO_PI 6.28318530717958647692\n\t\tfloat tween(float k) {\n\t\t    float s;\n\t\t    float a = 0.1;\n\t\t    float p = 0.4;\n\t\t    if ( k == 0.0 ) return 0.0;\n\t\t    if ( k == 1.0 ) return 1.0;\n\t\t    if ( a < 1.0 ) { a = 1.0; s = p * 0.25; }\n\t\t    else s = p * asin( 1.0 / a ) / TWO_PI;\n\t\t    if ( ( k *= 2.0 ) < 1.0 ) return - 0.5 * ( a * pow( 2.0, 10.0 * ( k -= 1.0 ) ) * sin( ( k - s ) * TWO_PI / p ) );\n\t\t    return a * pow( 2.0, -10.0 * ( k -= 1.0 ) ) * sin( ( k - s ) * TWO_PI / p ) * 0.5 + 1.0;\n\t\t}";break;case"inBack":t="float tween(float k) {\n\t\t    float s = 1.70158;\n\t\t    return k * k * ( ( s + 1.0 ) * k - s );\n\t\t}";break;case"outBack":t="float tween(float k) {\n\t\t    float s = 1.70158;\n\t\t    return --k * k * ( ( s + 1.0 ) * k + s ) + 1.0;\n\t\t}";break;case"inOutBack":t="float tween(float k) {\n\t\t    float s = 1.70158 * 1.525;\n\t\t    if ( ( k *= 2.0 ) < 1.0 ) return 0.5 * ( k * k * ( ( s + 1.0 ) * k - s ) );\n\t\t    return 0.5 * ( ( k -= 2.0 ) * k * ( ( s + 1.0 ) * k + s ) + 2.0 );\n\t\t}";break;case"inBounce":t="float outBounce(float k) {\n\t\t    if ( k < ( 1.0 / 2.75 ) ) return 7.5625 * k * k;\n\t\t    else if ( k < ( 2.0 / 2.75 ) ) return 7.5625 * ( k -= ( 1.5 / 2.75 ) ) * k + 0.75;\n\t\t    else if ( k < ( 2.5 / 2.75 ) ) return 7.5625 * ( k -= ( 2.25 / 2.75 ) ) * k + 0.9375;\n\t\t    else return 7.5625 * ( k -= ( 2.625 / 2.75 ) ) * k + 0.984375;\n\t\t}\n\t\tfloat tween(float k) { return 1.0 - outBounce( 1.0 - k ); }";break;case"outBounce":t="float tween(float k) {\n\t\t    if ( k < ( 1.0 / 2.75 ) ) return 7.5625 * k * k;\n\t\t    else if ( k < ( 2.0 / 2.75 ) ) return 7.5625 * ( k -= ( 1.5 / 2.75 ) ) * k + 0.75;\n\t\t    else if ( k < ( 2.5 / 2.75 ) ) return 7.5625 * ( k -= ( 2.25 / 2.75 ) ) * k + 0.9375;\n\t\t    else return 7.5625 * ( k -= ( 2.625 / 2.75 ) ) * k + 0.984375;\n\t\t}";break;case"inOutBounce":t="float outBounce(float k) {\n\t\t    if ( k < ( 1.0 / 2.75 ) ) return 7.5625 * k * k;\n\t\t    else if ( k < ( 2.0 / 2.75 ) ) return 7.5625 * ( k -= ( 1.5 / 2.75 ) ) * k + 0.75;\n\t\t    else if ( k < ( 2.5 / 2.75 ) ) return 7.5625 * ( k -= ( 2.25 / 2.75 ) ) * k + 0.9375;\n\t\t    else return 7.5625 * ( k -= ( 2.625 / 2.75 ) ) * k + 0.984375;\n\t\t}\n\t\tfloat inBounce(float k) { return 1.0 - outBounce( 1.0 - k ); }\n\t\tfloat tween(float k) {\n\t\t    if ( k < 0.5 ) return inBounce( k * 2.0 ) * 0.5;\n\t\t    return outBounce( k * 2.0 - 1.0 ) * 0.5 + 0.5;\n\t\t}"}return t},M=[[-.5,-.5],[.5,-.5],[.5,.5],[-.5,.5]],E=new Float32Array(28);class z extends i{constructor(e,t){super(),this.pe=e,this.count=0,this.color=null,this.texture=null,this.localTime=0,this.time=0,this.endTime=-1,this.num=0,this.matrixAutoUpdate=!1,this.frustumCulled=!1,this.receiveShadow=!1,this.castShadow=!1,this.birthIndex=0,this.luma=!0,t&&this.setParameters(t)}setParameters(e){this.validateParameters(e),this.geometry&&this.geometry.dispose(),this.material&&this.material.dispose(),this.name=e.name,this.isTrail=e.trail||!1,this.parameters=e;const t=this.isTrail?e.maxParticles:e.numParticles;this.allocateParticles_(t,e),this.isTrail||this.createParticles_(0,t,e),e.parent?e.parent.add(this):this.pe.scene.add(this)}makeGeometry(e){this.geometry=e.oriented?new r:new o,this.isMesh=e.oriented}setColorRamp(e){const t=e.length/4;if(t%1!=0)throw"colorRamp must have multiple of 4 entries";this.color=C.createTextureFromFloats(t,1,e)}validateParameters(e){var t=new L;for(let n in e)if(void 0===t[n])throw'unknown particle parameter "'+n+'"';for(let n in t)void 0===e[n]&&(e[n]=t[n])}perParticle(e,t){}birthParticles(e,t){var n=this.parameters.numParticles;this.parameters.pposition=e,this.parameters.startTime=this.time,this.endTime=this.time+this.parameters.lifeTime,t&&this.setColorRamp(t),this.createParticles_(this.birthIndex,n,this.parameters),this.birthIndex+=n,this.birthIndex+n>=this.parameters.maxParticles&&(this.birthIndex=0)}createParticles_(e,t,n){const a=C.plusMinus,i=C.plusMinusVector,r=this.interleavedBuffer.array;let o,h=t;for(;h--;){this.perParticle(h,n);let u,p=n.lifeTime+a(n.lifeTimeRange),f=null===n.startTime?h*n.lifeTime/t:n.startTime,g=n.frameStart+a(n.frameStartRange),m=(new s).addVectors((new s).fromArray(n.pposition),(new s).fromArray(i(n.positionRange))),b=(new s).addVectors((new s).fromArray(n.velocity),(new s).fromArray(i(n.velocityRange))),k=(new s).addVectors((new s).fromArray(n.acceleration),(new s).fromArray(i(n.accelerationRange))),v=(new l).addVectors((new l).fromArray(n.colorMult),(new l).fromArray(i(n.colorMultRange))),y=n.spinStart+a(n.spinStartRange),x=n.spinSpeed+a(n.spinSpeedRange),w=n.startSize+a(n.sizeRange||n.startSizeRange),S=n.endSize+a(n.sizeRange||n.endSizeRange),T=(new l).fromArray(n.orientation),L=n.positionRange[0]+n.positionRange[1]+n.positionRange[2]===0;if(n.radius){let e=C.rand(0,2*Math.PI);n.tmpRotation=[90,-e*C.todeg,90,"YXZ"];let t=n.radius+a(n.radiusRange),i=new s(Math.cos(e),0,Math.sin(e)).multiplyScalar(t);L&&(m=i),m.length(),u=k.y,k.multiply(i),k.y=u,u=b.y,b.multiply(i)}n.tmpRotation&&(T=(new c).setFromEuler(new d(n.tmpRotation[0]*C.torad,n.tmpRotation[1]*C.torad,n.tmpRotation[2]*C.torad,n.tmpRotation[3])));o=0+28*h*4+28*e*4,r[0+o]=m.x,r[0+o+1]=m.y,r[0+o+2]=m.z,r[0+o+3]=f,r[4+o]=M[0][0],r[4+o+1]=M[0][1],r[4+o+2]=p,r[4+o+3]=g,r[8+o]=b.x,r[8+o+1]=b.y,r[8+o+2]=b.z,r[8+o+3]=w,r[12+o]=k.x,r[12+o+1]=k.y,r[12+o+2]=k.z,r[12+o+3]=S,r[16+o]=y,r[16+o+1]=x,r[16+o+2]=0,r[16+o+3]=0,r[20+o]=T.x,r[20+o+1]=T.y,r[20+o+2]=T.z,r[20+o+3]=T.w,r[24+o]=v.x,r[24+o+1]=v.y,r[24+o+2]=v.z,r[24+o+3]=v.w}this.interleavedBuffer.needsUpdate=!0,this.material.uniforms.worldVelocity.value.fromArray(n.worldVelocity),this.material.uniforms.gravity.value.fromArray(n.gravity),this.material.uniforms.timeRange.value=n.timeRange,this.material.uniforms.frameDuration.value=n.frameDuration,this.material.uniforms.numFrames.value=n.numFrames,this.material.uniforms.rampSampler.value=this.color,this.material.uniforms.colorSampler.value=this.texture,this.material.blending="normal"===n.blending?u:p,this.updateMatrix()}allocateParticles_(e,t){if(this.count!==e){if(t.oriented||(t.oriented=!1),t.position&&this.position.fromArray(t.position),t.rotation&&this.quaternion.setFromEuler(new d(t.rotation[0]*C.torad,t.rotation[1]*C.torad,t.rotation[2]*C.torad)),this.setColorRamp(t.colors),this.texture=this.pe.textures.make(t.type),this.endTime=t.endTime||-1,this.luma=t.luma,this.makeGeometry(t),this.count=e,t.oriented){var n=new h(new Float32Array([0,0,0,0,-.5,-.5,0,0,0,0,0,0,.5,-.5,0,0,0,0,0,0,.5,.5,0,0,0,0,0,0,-.5,.5,0,0]),8);this.geometry.setAttribute("position",new f(n,3,0)),this.geometry.setAttribute("uv",new f(n,2,4)),this.geometry.setIndex(new g(new Uint16Array([0,1,2,0,2,3]),1)),this.interleavedBuffer=new m(new Float32Array(e*E.byteLength),28,1).setUsage(b)}else this.interleavedBuffer=new h(new Float32Array(e*E.byteLength),28).setUsage(b);this.geometry.setAttribute("position",new f(this.interleavedBuffer,3,0)),this.geometry.setAttribute("startTime",new f(this.interleavedBuffer,1,3)),this.geometry.setAttribute("uvLifeTimeFrameStart",new f(this.interleavedBuffer,4,4)),this.geometry.setAttribute("velocityStartSize",new f(this.interleavedBuffer,4,8)),this.geometry.setAttribute("accelerationEndSize",new f(this.interleavedBuffer,4,12)),this.geometry.setAttribute("spinStartSpinSpeed",new f(this.interleavedBuffer,4,16)),this.geometry.setAttribute("orientation",new f(this.interleavedBuffer,4,20)),this.geometry.setAttribute("colorMult",new f(this.interleavedBuffer,4,24)),this.geometry.boundingSphere=new k,this.geometry.boundingSphere.radius=3;let i=p;switch(t.blending){case"sub":case"subtractive":i=S;break;case"multi":case"multiply":i=w;break;case"normal":i=u;break;default:i=p}var a={worldVelocity:{value:new s},gravity:{value:new s},timeRange:{value:0},time:{value:0},timeOffset:{value:0},frameDuration:{value:0},numFrames:{value:0},rampSampler:{value:null},colorSampler:{value:null},scale:{value:.5*window.innerHeight},luma:{value:this.luma?this.pe.luminosity:1},alphaTest:{value:t.alphaTest}};this.material=new v({defines:{USE_ORIENTATION:t.oriented},uniforms:a,vertexShader:(this.pe.isGl2?"":"\nmat4 inverse(mat4 m) {\n\n    float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3], a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3], a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3], a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n    b00 = a00 * a11 - a01 * a10,\n    b01 = a00 * a12 - a02 * a10,\n    b02 = a00 * a13 - a03 * a10,\n    b03 = a01 * a12 - a02 * a11,\n    b04 = a01 * a13 - a03 * a11,\n    b05 = a02 * a13 - a03 * a12,\n    b06 = a20 * a31 - a21 * a30,\n    b07 = a20 * a32 - a22 * a30,\n    b08 = a20 * a33 - a23 * a30,\n    b09 = a21 * a32 - a22 * a31,\n    b10 = a21 * a33 - a23 * a31,\n    b11 = a22 * a33 - a23 * a32,\n\n  det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4( a11 * b11 - a12 * b10 + a13 * b09, a02 * b10 - a01 * b11 - a03 * b09, a31 * b05 - a32 * b04 + a33 * b03, a22 * b04 - a21 * b05 - a23 * b03, a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07, a32 * b02 - a30 * b05 - a33 * b01, a20 * b05 - a22 * b02 + a23 * b01, a10 * b10 - a11 * b08 + a13 * b06, a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00, a21 * b02 - a20 * b04 - a23 * b00, a11 * b07 - a10 * b09 - a12 * b06, a00 * b09 - a01 * b07 + a02 * b06, a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n")+A(t.tween||"linear")+"\nprecision mediump float;\nprecision mediump int;\n\n#ifdef USE_ORIENTATION\n\t//uniform mat4 worldViewProjection;\n\t//uniform mat4 world;\n\tattribute vec3 offset;\n\tattribute vec4 orientation;\n#else\n    uniform float scale;\n#endif\n\nuniform vec3 worldVelocity;\nuniform vec3 gravity;\nuniform float timeRange;\nuniform float time;\nuniform float timeOffset;\nuniform float frameDuration;\nuniform float numFrames;\n\nattribute vec4 uvLifeTimeFrameStart;\nattribute float startTime;\nattribute vec4 velocityStartSize;\nattribute vec4 accelerationEndSize;\nattribute vec4 spinStartSpinSpeed;\nattribute vec4 colorMult;\n\nvarying vec2 outputTexcoord;\nvarying float outputPercentLife;\nvarying vec4 outputColorMult;\nvarying mat2 rotationMtx;\n\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n//#include <clipping_planes_pars_vertex>\n\nvec3 lerp( vec3 a, vec3 b, float p ){ return a + (b - a) * p; }\n\nvoid main() \n{\n    float lifeTime = uvLifeTimeFrameStart.z;\n    float frameStart = uvLifeTimeFrameStart.w;\n    float startSize = velocityStartSize.w;\n\n    //vec3 velocity = (modelMatrix * vec4(velocityStartSize.xyz, 0.0)).xyz + worldVelocity;\n\t//vec3 acceleration = (modelMatrix * vec4(accelerationEndSize.xyz, 0.0)).xyz + gravity;\n\n    //vec3 velocity = velocityStartSize.xyz + worldVelocity;\n\t//vec3 acceleration = accelerationEndSize.xyz + gravity;\n\n\tvec3 velocity = velocityStartSize.xyz + (inverse(modelMatrix) * vec4(worldVelocity, 0.0)).xyz;\n\tvec3 acceleration = accelerationEndSize.xyz + (inverse(modelMatrix) * vec4(gravity, 0.0)).xyz;\n\n    float endSize = accelerationEndSize.w;\n    float spinStart = spinStartSpinSpeed.x;\n    float spinSpeed = spinStartSpinSpeed.y;\n\n    float localTime = mod((time - timeOffset - startTime), timeRange);\n    //localTime = tween( localTime );\n    float percentLife = localTime / lifeTime;\n    percentLife = tween( percentLife );\n\n    vec3 posEnd = velocity * lifeTime + acceleration * lifeTime * lifeTime;\n\n    float frame = mod(floor(localTime / frameDuration + frameStart), numFrames);\n    float uOffset = frame / numFrames;\n    float u = uOffset + (uv.x + 0.5) * (1. / numFrames);\n\n    outputTexcoord = vec2(u, uv.y + 0.5);\n    outputColorMult = colorMult;\n\n    float size = mix(startSize, endSize, percentLife);\n\tsize = (percentLife < 0. || percentLife > 1.0) ? 0.0 : size;\n\n\tfloat s = sin(spinStart + spinSpeed * localTime);\n\tfloat c = cos(spinStart + spinSpeed * localTime);\n\n    #ifdef USE_ORIENTATION\n\t\t\n\t\tvec4 rotatedPoint = vec4((uv.x * c + uv.y * s) * size, 0., (uv.x * s - uv.y * c) * size, 1.);\n\t\t//vec3 center = velocity * localTime + acceleration * localTime * localTime + position + offset;\n\t\tvec3 center = (posEnd * percentLife) + position + offset;\n\n\t\tvec4 q2 = orientation + orientation;\n\t\tvec4 qx = orientation.xxxw * q2.xyzx;\n\t\tvec4 qy = orientation.xyyw * q2.xyzy;\n\t\tvec4 qz = orientation.xxzw * q2.xxzz;\n\n\t\tmat4 localMatrix = mat4(\n\t\t    (1.0 - qy.y) - qz.z,  qx.y + qz.w,  qx.z - qy.w, 0,\n\t\t    qx.y - qz.w, (1.0 - qx.x) - qz.z, qy.z + qx.w, 0,\n\t\t    qx.z + qy.w, qy.z - qx.w, (1.0 - qx.x) - qy.y, 0,\n\t\t    center.x, center.y, center.z, 1\n\t\t);\n\t\trotatedPoint = localMatrix * rotatedPoint;\n\t\tgl_Position = projectionMatrix * modelViewMatrix * rotatedPoint;\n\n\t#else\n\n\t    //vec3 pos = position + velocity * localTime + acceleration * localTime * localTime;\n\n\t    vec3 pos = (posEnd * percentLife) + position;\n\t    \n\t    vec4 mvPosition = modelViewMatrix * vec4( pos, 1.0 );\n        //gl_PointSize = size * 1.5 * ( scale / length( mvPosition.xyz ) );\n        gl_PointSize = size * 1.5 * ( scale / - mvPosition.z );\n\n        mat2 r = mat2( c, -s, s, c);\n        r *= 0.5; r += 0.5;  r = r * 2.0 - 1.0;\n        rotationMtx = r;\n\n        gl_Position = projectionMatrix * mvPosition;\n\n\t#endif\n\n\toutputPercentLife = percentLife;\n\n\t#include <logdepthbuf_vertex>\n\t//#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\n\nuniform sampler2D rampSampler;\nuniform sampler2D colorSampler;\nuniform float luma;\nuniform float alphaTest;\n\nvarying vec2 outputTexcoord;\nvarying float outputPercentLife;\nvarying vec4 outputColorMult;\nvarying mat2 rotationMtx;\n\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n//#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t//#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\n\tvec4 diffuseColor = texture2D( rampSampler, vec2(outputPercentLife, 0.5) ) * outputColorMult;\n\n    vec2 uv = vec2(0.0);\n    #ifdef USE_ORIENTATION\n        uv = outputTexcoord;\n\t#else\n\t    uv = gl_PointCoord;\n\t    uv -= 0.5; uv = uv * rotationMtx; uv += 0.5;\n\t#endif\n\n\t// texture\n\tdiffuseColor *= texture2D( colorSampler, uv );\n\n\tif ( diffuseColor.a < alphaTest ) discard;\n\n\tdiffuseColor.rgb *= luma;\n\n\tgl_FragColor = diffuseColor; \n\t#include <fog_fragment>\n\n}\n",side:t.oriented?y:x,blending:i,depthTest:!0,depthWrite:t.depthWrite,transparent:t.transparent}),this.renderOrder=t.renderOrder||0}}draw(e=0){if(!this.material.uniforms)return;const t=this.material.uniforms;this.time+=this.pe.delta,t.time.value=this.time,t.timeOffset.value=e,t.scale.value=this.pe.hscale,t.luma.value=this.luma?this.pe.luminosity:1,-1!==this.endTime&&this.time>=this.endTime&&this.pe.remove(this.name)}dispose(){this.parent.remove(this),this.geometry.dispose(),this.material.dispose(),this.color.dispose()}raycast(){}clone(e){return void 0===e&&(e=this.pe.createEmitter(this.texture)),e.time=0,e.endTime=this.endTime,e.geometry=this.geometry,e.material=this.material.clone(),e.material.uniforms.rampSampler.value=this.color,e.material.uniforms.colorSampler.value=this.texture,super.copy(e),this.num++,e.name=this.name+this.num,e}}class F extends Map{constructor(){super()}dispose(){this.forEach((e=>{e.dispose()})),this.clear()}make(e){if(!this.has(e)){let t=this["make"+e[0].toUpperCase()+e.substring(1)]();this.set(e,t)}return this.get(e)}makePixel(){const e=[];for(let t=0;t<2;++t)for(let t=0;t<2;++t)e.push(1,1,1,1);return C.createTextureFromFloats(2,2,e)}makeBasic(){const e=[0,.2,.7,1,.7,.2,0,0],t=[];for(let n=0;n<8;++n)for(let a=0;a<8;++a){let i=e[a]*e[n];t.push(i,i,i,1)}return C.createTextureFromFloats(8,8,t)}makeCube(){let e=document.createElement("canvas");e.width=e.height=8;const t=e.getContext("2d");return t.fillStyle="rgba(255,255,255,1.0)",t.fillRect(2,2,4,4),C.toTexture(e)}makeCloud(){let e=16,t=document.createElement("canvas");t.width=t.height=e;const n=t.getContext("2d");let a="rgba(255,255,255,1)",i="rgba(255,255,255,0)",r=n.createRadialGradient(8,6.4,0,8,6.4,6.4);return r.addColorStop(.3,a),r.addColorStop(1,i),n.fillStyle=r,n.fillRect(0,0,e,e),r=n.createRadialGradient(6.4,9.92,0,6.4,9.92,5.6),r.addColorStop(.3,a),r.addColorStop(1,i),n.fillStyle=r,n.fillRect(0,0,e,e),r=n.createRadialGradient(4.32,6.4,0,4.32,6.4,4.16),r.addColorStop(.2,a),r.addColorStop(1,i),n.fillStyle=r,n.fillRect(0,0,e,e),r=n.createRadialGradient(12.16,9.6,0,12.16,9.6,3.68),r.addColorStop(.2,a),r.addColorStop(1,i),n.fillStyle=r,n.fillRect(0,0,e,e),C.toTexture(t)}makeRound(){let e=16,t=document.createElement("canvas");t.width=t.height=e;const n=t.getContext("2d"),a=n.createRadialGradient(8,8,0,8,8,8);return a.addColorStop(0,"rgba(255,255,255,1)"),a.addColorStop(.3,"rgba(255,255,255,0.1)"),a.addColorStop(.9,"rgba(255,255,255,0)"),a.addColorStop(1,"rgba(255,255,255,0)"),n.fillStyle=a,n.fillRect(0,0,e,e),C.toTexture(t)}makeRound2(){let e=16,t=document.createElement("canvas");t.width=t.height=e;const n=t.getContext("2d"),a=n.createRadialGradient(8,8,0,8,8,8);return a.addColorStop(0,"rgba(255,255,255,1)"),a.addColorStop(.9,"rgba(255,255,255,1)"),a.addColorStop(1,"rgba(255,255,255,0)"),n.fillStyle=a,n.fillRect(0,0,e,e),C.toTexture(t)}makeDonut(){let e=32,t=document.createElement("canvas");t.width=t.height=e;const n=t.getContext("2d"),a=n.createRadialGradient(16,16,0,16,16,16);return a.addColorStop(0,"rgba(255,255,255,1)"),a.addColorStop(.9,"rgba(255,255,255,0.1)"),a.addColorStop(1,"rgba(255,255,255,0)"),n.fillStyle=a,n.beginPath(),n.arc(16,16,16,0,2*Math.PI,!1),n.arc(16,16,8,0,2*Math.PI,!0),n.fill(),C.toTexture(t)}makeBubble(){let e=64,t=document.createElement("canvas");t.width=t.height=e;let n="rgba(0,255,255,0)";const a=t.getContext("2d"),i=a.createRadialGradient(25.6,25.6,0,32,32,32);return i.addColorStop(.4,n),i.addColorStop(.9,"rgba(0,255,255,0.6)"),i.addColorStop(.99,"rgba(0,255,255,1)"),i.addColorStop(1,n),a.fillStyle=i,a.fillRect(0,0,e,e),a.fillStyle="rgba(255,255,255,1)",a.beginPath(),a.arc(44.8,25.6,8.96,0,2*Math.PI,!1),a.fill(),a.beginPath(),a.arc(12.8,41.6,3.2,0,2*Math.PI,!1),a.fill(),C.toTexture(t)}makeSmoke(){let e=document.createElement("canvas");e.width=e.height=64;const t=e.getContext("2d");let n=new Image;n.src=P;let a=C.toTexture(e);return n.onload=function(){t.drawImage(n,0,0),a.needsUpdate=!0},a}makeCircle(){let e=document.createElement("canvas");e.width=e.height=64;const t=e.getContext("2d");return t.strokeStyle="white",t.lineWidth=4,t.beginPath(),t.arc(32,32,30,0,2*Math.PI),t.stroke(),C.toTexture(e)}makeField(){let e=64,t=document.createElement("canvas");t.width=t.height=e;const n=t.getContext("2d"),a=n.createLinearGradient(0,0,0,e);return a.addColorStop(0,"rgba(255,255,255,0)"),a.addColorStop(.8,"rgba(255,255,255,0.4)"),a.addColorStop(1,"rgba(255,255,255,0)"),n.fillStyle=a,n.fillRect(24,0,16,e),C.toTexture(t)}makeStar(){let e=64,t=document.createElement("canvas");t.width=t.height=e;const n=t.getContext("2d"),a=n.createRadialGradient(32,32,0,32,32,32);return a.addColorStop(0,"rgba(255,255,255,0.5)"),a.addColorStop(.5,"rgba(255,255,255,0.1)"),a.addColorStop(.9,"rgba(255,255,255,0)"),n.fillStyle=a,this.star(n,32,6.4,32,32,3),this.star(n,32,25.6,32,32,3),C.toTexture(t)}makeOcto(){let e=64,t=document.createElement("canvas");t.width=t.height=e;const n=t.getContext("2d"),a=n.createRadialGradient(32,32,0,32,32,32);return a.addColorStop(.4,"rgba(255,255,255,0.2)"),a.addColorStop(1,"rgba(255,255,255,0.4)"),n.fillStyle=a,this.star(n,25.6,22.4,32,32,6),n.strokeStyle="rgba(255,255,255,0.1)",n.lineWidth=6,n.stroke(),C.toTexture(t)}star(e,t,n,a,i,r){let o,s,l;e.beginPath(),e.moveTo(a+t,i);for(var c=1;c<=2*r;c++)c%2==0?(l=c*(2*Math.PI)/(2*r),o=a+t*Math.cos(l),s=i+t*Math.sin(l)):(l=c*(2*Math.PI)/(2*r),o=a+n*Math.cos(l),s=i+n*Math.sin(l)),e.lineTo(o,s);e.closePath(),e.fill()}}const P="data:image/png;base64,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\nJRU5ErkJggg==";class R{constructor(e,t){this.scene=e,this.isGl2=t.capabilities.isWebGL2,this.emitters=new Map,this.textures=new F,this.now=0,this.last=0,this.delta=0,this.num=0,this.hscale=.5*window.innerHeight,this.luminosity=1}get(e){return this.emitters.has(e)?this.emitters.get(e):null}add(e,t){e.name||(e.name="PP"+this.num++),this.remove(e.name),e.model&&T[e.model]&&(e={...T[e.model],...e});let n=new z(this,e);return this.emitters.set(e.name,n),n}remove(e){this.emitters.has(e)&&(this.emitters.get(e).dispose(),this.emitters.delete(e))}onresize(e){this.hscale=.5*e}update(e){this.now=void 0!==e?e:Date.now(),this.delta=.001*(this.now-this.last),this.last=this.now,this.emitters.forEach((e=>{e.draw()}))}dispose(){this.emitters.forEach((e=>{e.dispose()})),this.emitters.clear(),this.textures.dispose(),this.num=0}addBlock(e,t){let n=e[1]<=4?-2:0,a=T.getColor(t),i=a[0],r=a[1],o=a[2];a.length>3&&(i=a[3],r=a[4],o=a[5]),e[0]+=.5,e[2]+=.5,this.add({position:e,colors:[i,r,o,1,i,r,o,0],renderOrder:n,...T.addBlock})}delBlock(e,t){let n=e[1]<=4?-2:0,a=T.getColor(t),i=a[0],r=a[1],o=a[2];e[0]+=.5,e[2]+=.5,e[1]+=.5;let s=30;a.length>3&&(s=20,this.add({position:[e[0],e[1]+.375,e[2]],positionRange:[.5,.25,.5],colors:[i,r,o,.5,i,r,o,0],numParticles:10,renderOrder:n,...T.removeBlock}),i=a[3],r=a[4],o=a[5]),this.add({position:e,positionRange:[.5,.5,.5],colors:[i,r,o,.5,i,r,o,0],numParticles:s,renderOrder:n,...T.removeBlock})}removePlayerTrail(e){this.remove("PlayerTrail_"+e)}onPlayerWalk(e,t,n){let a=this.get("PlayerTrail_"+t);null===a&&(a=this.addTrail({name:"PlayerTrail_"+t,...T.playerMove}));let i=e.toArray();i[1]+=.2;let r=T.getColor(n),o=[r[0],r[1],r[2],.75,r[0],r[1],r[2],0];r.length>3&&(o=[r[0],r[1],r[2],.75,r[3],r[4],r[5],0]),a.birthParticles(i,o)}onVehicleDrive(e,t){let n=this.get("VehicleTrail_"+t);null===n&&(n=this.addTrail({name:"VehicleTrail_"+t,...T.vehicleMove})),n.birthParticles(e.toArray())}onBazookaFire(e,t){let n=this.get("BazookaTrail_"+t);null===n&&(n=this.addTrail({name:"BazookaTrail_"+t,...T.bazookaFire})),n.birthParticles(e.toArray())}onExplosion(e){this.add({position:e.toArray(),...T.explosion})}}
/**
 * @license
 * Copyright 2010-2021 Uil.js Authors
 * SPDX-License-Identifier: MIT
 */const I={ui:[],dom:null,ID:null,lock:!1,wlock:!1,current:-1,needReZone:!0,needResize:!1,forceZone:!1,isEventsInit:!1,isLeave:!1,downTime:0,prevTime:0,prevDefault:["contextmenu"],pointerEvent:["pointerdown","pointermove","pointerup"],eventOut:["pointercancel","pointerout","pointerleave"],xmlserializer:null,tmpTime:null,tmpImage:null,oldCursor:"auto",input:null,parent:null,firstImput:!0,hiddenImput:null,hiddenSizer:null,hasFocus:!1,startInput:!1,inputRange:[0,0],cursorId:0,str:"",pos:0,startX:-1,moveX:-1,debugInput:!1,isLoop:!1,listens:[],e:{type:null,clientX:0,clientY:0,keyCode:NaN,key:null,delta:0},isMobile:!1,now:null,getTime:function(){return self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now},add:function(e){I.ui.push(e),I.getZone(e),I.isEventsInit||I.initEvents()},testMobile:function(){let e=navigator.userAgent;return!!(e.match(/Android/i)||e.match(/webOS/i)||e.match(/iPhone/i)||e.match(/iPad/i)||e.match(/iPod/i)||e.match(/BlackBerry/i)||e.match(/Windows Phone/i))},remove:function(e){let t=I.ui.indexOf(e);-1!==t&&(I.removeListen(e),I.ui.splice(t,1)),0===I.ui.length&&I.removeEvents()},initEvents:function(){if(I.isEventsInit)return;let e=document.body;I.isMobile=I.testMobile(),I.now=I.getTime(),I.isMobile?e.style.touchAction="none":e.addEventListener("wheel",I,{passive:!1}),e.addEventListener("pointercancel",I),e.addEventListener("pointerleave",I),e.addEventListener("pointermove",I),e.addEventListener("pointerdown",I),e.addEventListener("pointerup",I),e.addEventListener("keydown",I,!1),e.addEventListener("keyup",I,!1),window.addEventListener("resize",I.resize,!1),I.isEventsInit=!0,I.dom=e},removeEvents:function(){if(!I.isEventsInit)return;let e=document.body;I.isMobile||e.removeEventListener("wheel",I),e.removeEventListener("pointercancel",I),e.removeEventListener("pointerleave",I),e.removeEventListener("pointermove",I),e.removeEventListener("pointerdown",I),e.removeEventListener("pointerup",I),e.removeEventListener("keydown",I),e.removeEventListener("keyup",I),window.removeEventListener("resize",I.resize),I.isEventsInit=!1},resize:function(){let e,t=I.ui.length;for(;t--;)e=I.ui[t],e.isGui&&!e.isCanvasOnly&&e.autoResize&&e.calc();I.needReZone=!0,I.needResize=!1},out:function(){console.log("im am out"),I.clearOldID()},in:function(){console.log("im am in")},fakeUp:function(){this.handleEvent({type:"pointerup"})},handleEvent:function(e){-1!==I.prevDefault.indexOf(e.type)&&e.preventDefault(),I.needResize&&I.resize(),I.findZone(I.forceZone);let t=I.e,n=!1;"keydown"===e.type&&I.keydown(e),"keyup"===e.type&&I.keyup(e),"wheel"===e.type?t.delta=e.deltaY>0?1:-1:t.delta=0;let a=e.pointerType;if(t.clientX=("touch"===a?e.pageX:e.clientX)||0,t.clientY=("touch"===a?e.pageY:e.clientY)||0,t.type=e.type,-1!==I.eventOut.indexOf(e.type)&&(n=!0,t.type="mouseup"),"pointerleave"===e.type&&(I.isLeave=!0),"pointerdown"===e.type&&(t.type="mousedown"),"pointerup"===e.type&&(t.type="mouseup"),"pointermove"===e.type&&(I.isLeave&&(I.isLeave=!1,I.resize()),t.type="mousemove"),"mousedown"===t.type){if(I.downTime=I.now(),I.downTime-I.prevTime<200)return I.selectAll(),!1;I.prevTime=I.downTime,I.forceZone=!1}"mousedown"===t.type&&I.clearInput(),"mousedown"===t.type&&(I.lock=!0),"mouseup"===t.type&&(I.lock=!1),I.isMobile&&"mousedown"===t.type&&I.findID(t),"mousemove"!==t.type||I.lock||I.findID(t),null!==I.ID&&(I.ID.isCanvasOnly&&(t.clientX=I.ID.mouse.x,t.clientY=I.ID.mouse.y),I.ID.handleEvent(t)),I.isMobile&&"mouseup"===t.type&&I.clearOldID(),n&&I.clearOldID()},findID:function(e){let t,n,a,i=I.ui.length,r=-1;for(;i--;)if(t=I.ui[i],t.isCanvasOnly?(n=t.mouse.x,a=t.mouse.y):(n=e.clientX,a=e.clientY),I.onZone(t,n,a)){r=i,r!==I.current&&(I.clearOldID(),I.current=r,I.ID=t);break}-1===r&&I.clearOldID()},clearOldID:function(){I.ID&&(I.current=-1,I.ID.reset(),I.ID=null,I.cursor())},calcUis:(e,t,n,a=!1)=>{let i,r,o,s=e.length,l=0,c=0,d=0;for(;s--;)i=e[c],c++,!a&&i.isGroup&&i.calcUis(),o=i.margin,i.zone.w=i.w,i.zone.h=i.h+o,i.autoWidth?(l=0,i.zone.x=t.x+i.dx,i.zone.y=n,n+=i.h+o,d+=i.h+o):(0===l&&(d+=i.h+o),i.zone.x=t.x+l,i.zone.y=n,r=I.getWidth(i),r?i.zone.w=i.w=r:i.fw&&(i.zone.w=i.w=i.fw),l+=i.zone.w,l>=t.w&&(n+=i.h+o,l=0));return d},findTarget:function(e,t){let n=e.length;for(;n--;)if(I.onZone(e[n],t.clientX,t.clientY))return n;return-1},findZone:function(e){if(I.needReZone||e){for(var t,n=I.ui.length;n--;)t=I.ui[n],I.getZone(t),t.isGui&&t.calcUis();I.needReZone=!1}},onZone:function(e,t,n){if(void 0===t||void 0===n)return!1;let a=e.zone,i=t-a.x,r=n-a.y,o=i>=0&&r>=0&&i<=a.w&&r<=a.h;return o?e.local.set(i,r):e.local.neg(),o},getWidth:function(e){return e.getDom().clientWidth},getZone:function(e){if(e.isCanvasOnly)return;let t=e.getDom().getBoundingClientRect();e.zone={x:t.left,y:t.top,w:t.width,h:t.height}},cursor:function(e){(e=e||"auto")!==I.oldCursor&&(document.body.style.cursor=e,I.oldCursor=e)},toCanvas:function(e,t,n,a){if(I.xmlserializer||(I.xmlserializer=new XMLSerializer),a&&null!==I.tmpTime&&(clearTimeout(I.tmpTime),I.tmpTime=null),null!==I.tmpTime)return;I.lock&&(I.tmpTime=setTimeout((function(){I.tmpTime=null}),10));let i=!1;t===e.canvas.width&&n===e.canvas.height||(i=!0),null===I.tmpImage&&(I.tmpImage=new Image);let r=I.tmpImage,o=I.xmlserializer.serializeToString(e.content),s='<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+n+'"><foreignObject style="pointer-events: none; left:0;" width="100%" height="100%">'+o+"</foreignObject></svg>";r.onload=function(){let a=e.canvas.getContext("2d");i?(e.canvas.width=t,e.canvas.height=n):a.clearRect(0,0,t,n),a.drawImage(this,0,0),e.onDraw()},r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(s),r.crossOrigin=""},setHidden:function(){null===I.hiddenImput&&(I.hiddenImput=document.createElement("input"),I.hiddenImput.type="text",I.hiddenSizer=document.createElement("div"),document.body.appendChild(I.hiddenImput),document.body.appendChild(I.hiddenSizer));let e=I.debugInput?"":"opacity:0; zIndex:0;",t=I.parent.css.txtselect+"padding:0; width:auto; height:auto; left:10px; top:auto; color:#FFF; background:#000;"+e;I.hiddenImput.style.cssText=t+"bottom:10px;"+(I.debugInput?"":"transform:scale(0);"),I.hiddenSizer.style.cssText=t+"bottom:40px;",I.hiddenImput.style.width=I.input.clientWidth+"px",I.hiddenImput.value=I.str,I.hiddenSizer.innerHTML=I.str,I.hasFocus=!0},clearHidden:function(e){null!==I.hiddenImput&&(I.hasFocus=!1)},clickPos:function(e){let t=I.str.length,n=0,a=0;for(;t--&&(n+=I.textWidth(I.str[a]),!(n>=e));)a++;return a},upInput:function(e,t){if(null===I.parent)return!1;let n=!1;if(t){let t=I.clickPos(e);I.moveX=t,-1===I.startX?(I.startX=t,I.cursorId=t,I.inputRange=[I.startX,I.startX]):I.moveX!==I.startX&&(I.startX>I.moveX?I.inputRange=[I.moveX,I.startX]:I.inputRange=[I.startX,I.moveX]),n=!0}else-1!==I.startX&&(I.hasFocus=!0,I.hiddenImput.focus(),I.hiddenImput.selectionStart=I.inputRange[0],I.hiddenImput.selectionEnd=I.inputRange[1],I.startX=-1,n=!0);return n&&I.selectParent(),n},selectAll:function(){I.parent&&(I.str=I.input.textContent,I.inputRange=[0,I.str.length],I.hasFocus=!0,I.hiddenImput.focus(),I.hiddenImput.selectionStart=I.inputRange[0],I.hiddenImput.selectionEnd=I.inputRange[1],I.cursorId=I.inputRange[1],I.selectParent())},selectParent:function(){var e=I.textWidth(I.str.substring(0,I.cursorId)),t=I.textWidth(I.str.substring(0,I.inputRange[0])),n=I.textWidth(I.str.substring(I.inputRange[0],I.inputRange[1]));I.parent.select(e,t,n,I.hiddenSizer.innerHTML)},textWidth:function(e){return null===I.hiddenSizer?0:(e=e.replace(/ /g,"&nbsp;"),I.hiddenSizer.innerHTML=e,I.hiddenSizer.clientWidth)},clearInput:function(){null!==I.parent&&(I.firstImput||I.parent.validate(!0),I.clearHidden(),I.parent.unselect(),I.input.style.background=I.parent.colors.back,I.input.style.borderColor=I.parent.colors.border,I.parent.isEdit=!1,I.input=null,I.parent=null,I.str="",I.firstImput=!0)},setInput:function(e,t){I.clearInput(),I.input=e,I.parent=t,I.input.style.background=I.parent.colors.backoff,I.input.style.borderColor=I.parent.colors.select,I.str=I.input.textContent,I.setHidden()},keydown:function(e){if(null===I.parent)return;let t=e.which;e.shiftKey,I.firstImput=!1,I.hasFocus&&(window.focus(),I.hiddenImput.focus()),I.parent.isEdit=!0,13===t?I.clearInput():I.input.isNum?e.keyCode>47&&e.keyCode<58||e.keyCode>95&&e.keyCode<106||190===e.keyCode||110===e.keyCode||8===e.keyCode||109===e.keyCode?I.hiddenImput.readOnly=!1:I.hiddenImput.readOnly=!0:I.hiddenImput.readOnly=!1},keyup:function(e){null!==I.parent&&(I.str=I.hiddenImput.value,I.parent.allEqual?I.parent.sameStr(I.str):I.input.textContent=I.str,I.cursorId=I.hiddenImput.selectionStart,I.inputRange=[I.hiddenImput.selectionStart,I.hiddenImput.selectionEnd],I.selectParent(),I.parent.validate())},loop:function(){I.isLoop&&requestAnimationFrame(I.loop),I.update()},update:function(){let e=I.listens.length;for(;e--;)I.listens[e].listening()},removeListen:function(e){let t=I.listens.indexOf(e);-1!==t&&I.listens.splice(t,1),0===I.listens.length&&(I.isLoop=!1)},addListen:function(e){return-1===I.listens.indexOf(e)&&(I.listens.push(e),I.isLoop||(I.isLoop=!0,I.loop()),!0)}},_=I,O={transition:.2,frag:document.createDocumentFragment(),colorRing:null,joystick_0:null,joystick_1:null,circular:null,knob:null,pad2d:null,svgns:"http://www.w3.org/2000/svg",links:"http://www.w3.org/1999/xlink",htmls:"http://www.w3.org/1999/xhtml",DOM_SIZE:["height","width","top","left","bottom","right","margin-left","margin-right","margin-top","margin-bottom"],SVG_TYPE_D:["pattern","defs","transform","stop","animate","radialGradient","linearGradient","animateMotion","use","filter","feColorMatrix"],SVG_TYPE_G:["svg","rect","circle","path","polygon","text","g","line","foreignObject"],PI:Math.PI,TwoPI:2*Math.PI,pi90:.5*Math.PI,pi60:Math.PI/3,torad:Math.PI/180,todeg:180/Math.PI,clamp:(e,t,n)=>(e=e<t?t:e)>n?n:e,isDivid:e=>.5*e===Math.floor(.5*e),size:{w:240,h:20,p:30,s:8},defineColor:(e,t=O.colors)=>{let n={...t},a=["fontFamily","fontWeight","fontShadow","fontSize"],i=!1;e.font&&(e.fontFamily=e.font),e.shadow&&(e.fontShadow=e.shadow),e.weight&&(e.fontWeight=e.weight),e.fontColor&&(e.text=e.fontColor),e.color&&(e.text=e.color),e.text&&(n.text=e.text,e.fontColor||e.color||(n.title=O.ColorLuma(e.text,-.25),n.titleoff=O.ColorLuma(e.text,-.5)),n.textOver=O.ColorLuma(e.text,.25),n.textSelect=O.ColorLuma(e.text,.5)),e.button&&(n.button=e.button,n.border=O.ColorLuma(e.button,.1),n.overoff=O.ColorLuma(e.button,.2)),e.select&&(n.select=e.select,n.over=O.ColorLuma(e.select,-.1)),e.itemBg&&(e.back=e.itemBg),e.back&&(n.back=e.back,n.backoff=O.ColorLuma(e.back,-.1)),e.fontSelect&&(n.textSelect=e.fontSelect),e.groupBorder&&(n.gborder=e.groupBorder),e.bgOver&&(n.backgroundOver=e.bgOver);for(let t in n)void 0!==e[t]&&(n[t]=e[t]);for(let t in e)-1!==a.indexOf(t)&&(i=!0);return i&&O.defineText(n),n},colors:{sx:4,sy:2,radius:2,showOver:1,content:"none",background:"rgba(50,50,50,0.15)",backgroundOver:"rgba(50,50,50,0.3)",title:"#CCC",titleoff:"#BBB",text:"#DDD",textOver:"#EEE",textSelect:"#FFF",back:"rgba(0,0,0,0.2)",backoff:"rgba(0,0,0,0.3)",border:"#4c4c4c",borderSize:1,gborder:"none",groups:"none",button:"#3c3c3c",overoff:"#5c5c5c",over:"#024699",select:"#308AFF",action:"#FF3300",fontFamily:"Consolas, monospace",fontWeight:"normal",fontShadow:"none",fontSize:12,joyOver:"rgba(48,138,255,0.25)",joyOut:"rgba(100,100,100,0.5)",joySelect:"#308AFF",hide:"rgba(0,0,0,0)"},css:{basic:"position:absolute; pointer-events:none; box-sizing:border-box; margin:0; padding:0; overflow:hidden; -o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select:none;",button:"display:flex; align-items:center; justify-content:center; text-align:center;",middle:"display:flex; align-items:center; justify-content:left; text-align:left; flex-direction: row-reverse;"},svgs:{g1:"M 6 4 L 0 4 0 6 6 6 6 4 M 6 0 L 0 0 0 2 6 2 6 0 Z",g2:"M 6 0 L 4 0 4 6 6 6 6 0 M 2 0 L 0 0 0 6 2 6 2 0 Z",group:"M 7 7 L 7 8 8 8 8 7 7 7 M 5 7 L 5 8 6 8 6 7 5 7 M 3 7 L 3 8 4 8 4 7 3 7 M 7 5 L 7 6 8 6 8 5 7 5 M 6 6 L 6 5 5 5 5 6 6 6 M 7 3 L 7 4 8 4 8 3 7 3 M 6 4 L 6 3 5 3 5 4 6 4 M 3 5 L 3 6 4 6 4 5 3 5 M 3 3 L 3 4 4 4 4 3 3 3 Z",arrow:"M 3 8 L 8 5 3 2 3 8 Z",arrowDown:"M 5 8 L 8 3 2 3 5 8 Z",arrowUp:"M 5 2 L 2 7 8 7 5 2 Z",solid:"M 13 10 L 13 1 4 1 1 4 1 13 10 13 13 10 M 11 3 L 11 9 9 11 3 11 3 5 5 3 11 3 Z",body:"M 13 10 L 13 1 4 1 1 4 1 13 10 13 13 10 M 11 3 L 11 9 9 11 3 11 3 5 5 3 11 3 M 5 4 L 4 5 4 10 9 10 10 9 10 4 5 4 Z",vehicle:"M 13 6 L 11 1 3 1 1 6 1 13 3 13 3 11 11 11 11 13 13 13 13 6 M 2.4 6 L 4 2 10 2 11.6 6 2.4 6 M 12 8 L 12 10 10 10 10 8 12 8 M 4 8 L 4 10 2 10 2 8 4 8 Z",articulation:"M 13 9 L 12 9 9 2 9 1 5 1 5 2 2 9 1 9 1 13 5 13 5 9 4 9 6 5 8 5 10 9 9 9 9 13 13 13 13 9 Z",character:"M 13 4 L 12 3 9 4 5 4 2 3 1 4 5 6 5 8 4 13 6 13 7 9 8 13 10 13 9 8 9 6 13 4 M 6 1 L 6 3 8 3 8 1 6 1 Z",terrain:"M 13 8 L 12 7 Q 9.06 -3.67 5.95 4.85 4.04 3.27 2 7 L 1 8 7 13 13 8 M 3 8 Q 3.78 5.420 5.4 6.6 5.20 7.25 5 8 L 7 8 Q 8.39 -0.16 11 8 L 7 11 3 8 Z",joint:"M 7.7 7.7 Q 8 7.45 8 7 8 6.6 7.7 6.3 7.45 6 7 6 6.6 6 6.3 6.3 6 6.6 6 7 6 7.45 6.3 7.7 6.6 8 7 8 7.45 8 7.7 7.7 M 3.35 8.65 L 1 11 3 13 5.35 10.65 Q 6.1 11 7 11 8.28 11 9.25 10.25 L 7.8 8.8 Q 7.45 9 7 9 6.15 9 5.55 8.4 5 7.85 5 7 5 6.54 5.15 6.15 L 3.7 4.7 Q 3 5.712 3 7 3 7.9 3.35 8.65 M 10.25 9.25 Q 11 8.28 11 7 11 6.1 10.65 5.35 L 13 3 11 1 8.65 3.35 Q 7.9 3 7 3 5.7 3 4.7 3.7 L 6.15 5.15 Q 6.54 5 7 5 7.85 5 8.4 5.55 9 6.15 9 7 9 7.45 8.8 7.8 L 10.25 9.25 Z",ray:"M 9 11 L 5 11 5 12 9 12 9 11 M 12 5 L 11 5 11 9 12 9 12 5 M 11.5 10 Q 10.9 10 10.45 10.45 10 10.9 10 11.5 10 12.2 10.45 12.55 10.9 13 11.5 13 12.2 13 12.55 12.55 13 12.2 13 11.5 13 10.9 12.55 10.45 12.2 10 11.5 10 M 9 10 L 10 9 2 1 1 2 9 10 Z",collision:"M 11 12 L 13 10 10 7 13 4 11 2 7.5 5.5 9 7 7.5 8.5 11 12 M 3 2 L 1 4 4 7 1 10 3 12 8 7 3 2 Z",map:"M 13 1 L 1 1 1 13 13 13 13 1 M 12 2 L 12 7 7 7 7 12 2 12 2 7 7 7 7 2 12 2 Z",material:"M 13 1 L 1 1 1 13 13 13 13 1 M 12 2 L 12 7 7 7 7 12 2 12 2 7 7 7 7 2 12 2 Z",texture:"M 13 4 L 13 1 1 1 1 4 5 4 5 13 9 13 9 4 13 4 Z",object:"M 10 1 L 7 4 4 1 1 1 1 13 4 13 4 5 7 8 10 5 10 13 13 13 13 1 10 1 Z",none:"M 9 5 L 5 5 5 9 9 9 9 5 Z",cursor:"M 4 7 L 1 10 1 12 2 13 4 13 7 10 9 14 14 0 0 5 4 7 Z",load:"M 13 8 L 11.5 6.5 9 9 9 3 5 3 5 9 2.5 6.5 1 8 7 14 13 8 M 9 2 L 9 0 5 0 5 2 9 2 Z",save:"M 9 12 L 5 12 5 14 9 14 9 12 M 11.5 7.5 L 13 6 7 0 1 6 2.5 7.5 5 5 5 11 9 11 9 5 11.5 7.5 Z",extern:"M 14 14 L 14 0 0 0 0 14 14 14 M 12 6 L 12 12 2 12 2 6 12 6 M 12 2 L 12 4 2 4 2 2 12 2 Z"},rezone(){_.needReZone=!0},getImput:function(){return!!_.input},setStyle:function(e){for(var t in e)O.colors[t]&&(O.colors[t]=e[t]);O.setText()},defineText:function(e){O.setText(e.fontSize,e.text,e.fontFamily,e.fontShadow,e.fontWeight)},setText:function(e,t,n,a,i){let r=O.colors;void 0===n&&(n=r.fontFamily),void 0===e&&(e=r.fontSize),void 0===a&&(a=r.fontShadow),void 0===i&&(i=r.fontWeight),isNaN(e)?-1===e.search("em")&&(e+="px"):e+="px",O.css.txt=O.css.basic+O.css.middle+" font-family:"+n+"; font-weight:"+i+"; font-size:"+e+"; color:"+r.text+"; padding:0px 8px; left:0; top:2px; height:16px; width:100px; overflow:hidden; white-space: nowrap; letter-spacing: normal;","none"!==a&&(O.css.txt+=" text-shadow: 1px 1px 1px "+a+";"),O.css.txtselect=O.css.txt+"padding:0px 4px; border:1px dashed "+r.border+";",O.css.item=O.css.txt+"padding:0px 4px; position:relative; margin-bottom:1px; "},cloneCss:function(){return{...O.css}},clone:function(e){return e.cloneNode(!0)},setSvg:function(e,t,n,a,i){-1===a?e.setAttributeNS(null,t,n):void 0!==i?e.childNodes[a||0].childNodes[i||0].setAttributeNS(null,t,n):e.childNodes[a||0].setAttributeNS(null,t,n)},setCss:function(e,t){for(let n in t)-1!==O.DOM_SIZE.indexOf(n)?e.style[n]=t[n]+"px":e.style[n]=t[n]},set:function(e,t){for(let n in t)"txt"===n&&(e.textContent=t[n]),"link"===n?e.setAttributeNS(O.links,"xlink:href",t[n]):e.setAttributeNS(null,n,t[n])},get:function(e,t){if(void 0===t)return e;if(!isNaN(t))return e.childNodes[t];if(t instanceof Array){if(2===t.length)return e.childNodes[t[0]].childNodes[t[1]];if(3===t.length)return e.childNodes[t[0]].childNodes[t[1]].childNodes[t[2]]}},dom:function(e,t,n,a,i){return e=e||"div",-1!==O.SVG_TYPE_D.indexOf(e)||-1!==O.SVG_TYPE_G.indexOf(e)?"svg"===e?(a=document.createElementNS(O.svgns,"svg"),O.set(a,n)):(void 0===a&&(a=document.createElementNS(O.svgns,"svg")),O.addAttributes(a,e,n,i)):a=void 0===a?document.createElementNS(O.htmls,e):a.appendChild(document.createElementNS(O.htmls,e)),t&&(a.style.cssText=t),void 0===i?a:a.childNodes[i||0]},addAttributes:function(e,t,n,a){let i=document.createElementNS(O.svgns,t);return O.set(i,n),O.get(e,a).appendChild(i),-1!==O.SVG_TYPE_G.indexOf(t)&&(i.style.pointerEvents="none"),i},clear:function(e){for(O.purge(e);e.firstChild;)e.firstChild.firstChild&&O.clear(e.firstChild),e.removeChild(e.firstChild)},purge:function(e){let t,n,a=e.attributes;if(a)for(t=a.length;t--;)n=a[t].name,"function"==typeof e[n]&&(e[n]=null);if(a=e.childNodes,a)for(t=a.length;t--;)O.purge(e.childNodes[t])},addSVGGlowEffect:function(){if(null!==document.getElementById("UILGlow"))return;let e=O.initUILEffects(),t=O.addAttributes(e,"filter",{id:"UILGlow",x:"-20%",y:"-20%",width:"140%",height:"140%"});O.addAttributes(t,"feGaussianBlur",{in:"SourceGraphic",stdDeviation:"3",result:"uilBlur"});let n=O.addAttributes(t,"feMerge",{});for(let e=0;e<=3;e++)O.addAttributes(n,"feMergeNode",{in:"uilBlur"});O.addAttributes(n,"feMergeNode",{in:"SourceGraphic"})},initUILEffects:function(){let e=document.getElementById("UILSVGEffects");return null===e&&(e=O.dom("svg",void 0,{id:"UILSVGEffects",width:"0",height:"0"}),document.body.appendChild(e)),e},ColorLuma:function(e,t){"n"===e&&(e="#000"),(e=String(e).replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;let n,a,i="#";for(a=0;a<3;a++)n=parseInt(e.substr(2*a,2),16),n=Math.round(Math.min(Math.max(0,n+n*t),255)).toString(16),i+=("00"+n).substr(n.length);return i},findDeepInver:function(e){return.3*e[0]+.59*e[1]+.11*e[2]<=.6},lerpColor:function(e,t,n){let a={};for(let i=0;i<3;i++)a[i]=e[i]+(t[i]-e[i])*n;return a},hexToHtml:function(e){return"#"+("000000"+(e=void 0===e?0:e).toString(16)).substr(-6)},htmlToHex:function(e){return e.toUpperCase().replace("#","0x")},u255:function(e,t){return parseInt(e.substring(t,t+2),16)/255},u16:function(e,t){return parseInt(e.substring(t,t+1),16)/15},unpack:function(e){return 7==e.length?[O.u255(e,1),O.u255(e,3),O.u255(e,5)]:4==e.length?[O.u16(e,1),O.u16(e,2),O.u16(e,3)]:void 0},p255:function(e){let t=Math.round(255*e).toString(16);return t.length<2&&(t="0"+t),t},pack:function(e){return"#"+O.p255(e[0])+O.p255(e[1])+O.p255(e[2])},htmlRgba:function(e,t){return e=O.unpack(e),"rgba("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+","+t+")"},htmlRgb:function(e,t){return"rgb("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+")"},pad:function(e){return 1==e.length&&(e="0"+e),e},rgbToHex:function(e){let t=Math.round(255*e[0]).toString(16),n=Math.round(255*e[1]).toString(16),a=Math.round(255*e[2]).toString(16);return"#"+O.pad(t)+O.pad(n)+O.pad(a)},hueToRgb:function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e},rgbToHsl:function(e){let t=e[0],n=e[1],a=e[2],i=Math.min(t,n,a),r=Math.max(t,n,a),o=r-i,s=0,l=0,c=(i+r)/2;return c>0&&c<1&&(l=o/(c<.5?2*c:2-2*c)),o>0&&(r==t&&r!=n&&(s+=(n-a)/o),r==n&&r!=a&&(s+=2+(a-t)/o),r==a&&r!=t&&(s+=4+(t-n)/o),s/=6),[s,l,c]},hslToRgb:function(e){let t,n,a=e[0],i=e[1],r=e[2];return 0===i?[r,r,r]:(n=r<=.5?r*(i+1):r+i-r*i,t=2*r-n,[O.hueToRgb(t,n,a+.33333),O.hueToRgb(t,n,a),O.hueToRgb(t,n,a-.33333)])},makeGradiant:function(e,t,n,a){O.dom(e,null,t,n,0);let i,r=n.childNodes[0].childNodes.length-1;for(let e=0;e<a.length;e++)i=a[e],O.dom("stop",null,{offset:i[0]+"%","stop-color":i[1],"stop-opacity":i[2]},n,[0,r])},makePad:function(e){let t=O.dom("svg",O.css.basic+"position:relative;",{viewBox:"0 0 256 256",width:256,height:256,preserveAspectRatio:"none"});B.dom("rect","",{x:28,y:28,width:200,height:200,fill:O.colors.back},t),B.dom("rect","",{x:38,y:38,width:180,height:180,fill:O.colors.button},t),B.dom("line","",{x1:38,y1:128,x2:218,y2:128,stroke:O.colors.back,"stroke-width":2},t),B.dom("line","",{x1:128,x2:128,y1:38,y2:218,stroke:O.colors.back,"stroke-width":2},t),B.dom("circle","",{cx:128,cy:128,r:5,stroke:O.colors.text,"stroke-width":5,fill:"none"},t),O.pad2d=t},makeKnob:function(e){let t=O.dom("svg",O.css.basic+"position:relative;",{viewBox:"0 0 128 128",width:128,height:128,preserveAspectRatio:"none"});O.dom("circle","",{cx:64,cy:64,r:34,fill:O.colors.button,stroke:"rgba(0,0,0,0.3)","stroke-width":8},t),O.dom("path","",{d:"",stroke:O.colors.text,"stroke-width":4,fill:"none","stroke-linecap":"round"},t),O.dom("circle","",{cx:64,cy:64,r:41,stroke:"rgba(0,0,0,0.1)","stroke-width":7,fill:"none"},t),O.dom("path","",{d:"",stroke:"rgba(255,255,255,0.3)","stroke-width":2,fill:"none","stroke-linecap":"round","stroke-opacity":.5},t),O.knob=t},makeCircular:function(e){let t=O.dom("svg",O.css.basic+"position:relative;",{viewBox:"0 0 128 128",width:128,height:128,preserveAspectRatio:"none"});O.dom("circle","",{cx:64,cy:64,r:40,stroke:"rgba(0,0,0,0.1)","stroke-width":10,fill:"none"},t),O.dom("path","",{d:"",stroke:O.colors.text,"stroke-width":7,fill:"none","stroke-linecap":"butt"},t),O.circular=t},makeJoystick:function(e){let t,n=Math.floor(49),a=Math.floor(.6*n),i=O.dom("svg",O.css.basic+"position:relative;",{viewBox:"0 0 128 128",width:128,height:128,preserveAspectRatio:"none"});if(O.dom("defs",null,{},i),O.dom("g",null,{},i),0===e){t=[[40,"rgb(0,0,0)",.3],[80,"rgb(0,0,0)",0],[90,"rgb(50,50,50)",.4],[100,"rgb(50,50,50)",0]],O.makeGradiant("radialGradient",{id:"grad",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},i,t),t=[[60,"rgb(0,0,0)",.5],[100,"rgb(0,0,0)",0]],O.makeGradiant("radialGradient",{id:"gradS",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},i,t);let e=["rgb(40,40,40)","rgb(48,48,48)","rgb(30,30,30)"],r=["rgb(1,90,197)","rgb(3,95,207)","rgb(0,65,167)"];t=[[30,e[0],1],[60,e[1],1],[80,e[1],1],[100,e[2],1]],O.makeGradiant("radialGradient",{id:"gradIn",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},i,t),t=[[30,r[0],1],[60,r[1],1],[80,r[1],1],[100,r[2],1]],O.makeGradiant("radialGradient",{id:"gradIn2",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},i,t),O.dom("circle","",{cx:64,cy:64,r:n,fill:"url(#grad)"},i),O.dom("circle","",{cx:69,cy:74,r:a+10,fill:"url(#gradS)"},i),O.dom("circle","",{cx:64,cy:64,r:a,fill:"url(#gradIn)"},i),O.joystick_0=i}else t=[[69,"rgb(0,0,0)",0],[70,"rgb(0,0,0)",.3],[100,"rgb(0,0,0)",0]],O.makeGradiant("radialGradient",{id:"gradX",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},i,t),O.dom("circle","",{cx:64,cy:64,r:n,fill:"none",stroke:"rgba(100,100,100,0.25)","stroke-width":"4"},i),O.dom("circle","",{cx:64,cy:64,r:a+14,fill:"url(#gradX)"},i),O.dom("circle","",{cx:64,cy:64,r:a,fill:"none",stroke:"rgb(100,100,100)","stroke-width":"4"},i),O.joystick_1=i},makeColorRing:function(){let e=O.dom("svg",O.css.basic+"position:relative;",{viewBox:"0 0 256 256",width:256,height:256,preserveAspectRatio:"none"});O.dom("defs",null,{},e),O.dom("g",null,{},e);let t,n,a,i,r,o,s,l,c,d=8/113/24*Math.PI,u=0,p=[];for(o=0;o<=24;++o){if(a=o/24,i=a*O.TwoPI,t=.5*(u+i),n=1/Math.cos(.5*(i-u)),r=[Math.sin(u),-Math.cos(u),Math.sin(t)*n,-Math.cos(t)*n,Math.sin(i),-Math.cos(i)],p[1]=O.rgbToHex(O.hslToRgb([a,1,.5])),o>0){for(s=6;s--;)r[s]=(113*r[s]+128).toFixed(2);l=" M"+r[0]+" "+r[1]+" Q"+r[2]+" "+r[3]+" "+r[4]+" "+r[5],c=[[0,p[0],1],[100,p[1],1]],O.makeGradiant("linearGradient",{id:"G"+o,x1:r[0],y1:r[1],x2:r[4],y2:r[5],gradientUnits:"userSpaceOnUse"},e,c),O.dom("path","",{d:l,"stroke-width":30,stroke:"url(#G"+o+")","stroke-linecap":"butt"},e,1)}u=i-d,p[0]=p[1]}c=[[0,"#FFFFFF",1],[50,"#FFFFFF",0],[50,"#000000",0],[100,"#000000",1]],O.makeGradiant("linearGradient",{id:"GL0",x1:0,y1:128-84.9,x2:0,y2:212.9,gradientUnits:"userSpaceOnUse"},e,c),c=[[0,"#7f7f7f",1],[50,"#7f7f7f",.5],[100,"#7f7f7f",0]],O.makeGradiant("linearGradient",{id:"GL1",x1:78.95,y1:0,x2:226,y2:0,gradientUnits:"userSpaceOnUse"},e,c),O.dom("g",null,{"transform-origin":"128px 128px",transform:"rotate(0)"},e),O.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"red"},e,2),O.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"url(#GL1)","stroke-width":1,stroke:"url(#GL1)"},e,2),O.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"url(#GL0)","stroke-width":1,stroke:"url(#GL0)"},e,2),O.dom("path","",{d:"M 255.75 136.5 Q 256 132.3 256 128 256 123.7 255.75 119.5 L 241 128 255.75 136.5 Z",fill:"none","stroke-width":2,stroke:"#000"},e,2),O.dom("circle","",{cx:128,cy:128,r:6,"stroke-width":2,stroke:"#000",fill:"none"},e),O.colorRing=e},icon:function(e,t,n){n=n||40;let a=["<svg xmlns='"+O.svgns+"' version='1.1' xmlns:xlink='"+O.htmls+"' style='pointer-events:none;' preserveAspectRatio='xMinYMax meet' x='0px' y='0px' width='"+n+"px' height='"+n+"px' viewBox='0 0 256 256'><g>"];switch(e){case"logo":a[1]="<path id='logoin' fill='"+t+"' stroke='none' d='"+O.logoFill_d+"'/>";break;case"donate":a[1]="<path id='logoin' fill='"+t+"' stroke='none' d='"+O.logo_donate+"'/>";break;case"neo":a[1]="<path id='logoin' fill='"+t+"' stroke='none' d='"+O.logo_neo+"'/>";break;case"phy":a[1]="<path id='logoin' stroke='"+t+"' stroke-width='49' stroke-linejoin='round' stroke-linecap='butt' fill='none' d='"+O.logo_phy+"'/>";break;case"config":a[1]="<path id='logoin' stroke='"+t+"' stroke-width='49' stroke-linejoin='round' stroke-linecap='butt' fill='none' d='"+O.logo_config+"'/>";break;case"github":a[1]="<path id='logoin' fill='"+t+"' stroke='none' d='"+O.logo_github+"'/>";break;case"save":a[1]="<path stroke='"+t+"' stroke-width='4' stroke-linejoin='round' stroke-linecap='round' fill='none' d='M 26.125 17 L 20 22.95 14.05 17 M 20 9.95 L 20 22.95'/><path stroke='"+t,a[1]+="' stroke-width='2.5' stroke-linejoin='round' stroke-linecap='round' fill='none' d='M 32.6 23 L 32.6 25.5 Q 32.6 28.5 29.6 28.5 L 10.6 28.5 Q 7.6 28.5 7.6 25.5 L 7.6 23'/>"}return a[2]="</g></svg>",a.join("\n")},logoFill_d:"\n    M 171 150.75 L 171 33.25 155.5 33.25 155.5 150.75 Q 155.5 162.2 147.45 170.2 139.45 178.25 128 178.25 116.6 178.25 108.55 170.2 100.5 162.2 100.5 150.75 \n    L 100.5 33.25 85 33.25 85 150.75 Q 85 168.65 97.55 181.15 110.15 193.75 128 193.75 145.9 193.75 158.4 181.15 171 168.65 171 150.75 \n    M 200 33.25 L 184 33.25 184 150.8 Q 184 174.1 167.6 190.4 151.3 206.8 128 206.8 104.75 206.8 88.3 190.4 72 174.1 72 150.8 L 72 33.25 56 33.25 56 150.75 \n    Q 56 180.55 77.05 201.6 98.2 222.75 128 222.75 157.8 222.75 178.9 201.6 200 180.55 200 150.75 L 200 33.25 Z\n    ",logo_github:"\n    M 180.5 70 Q 186.3 82.4 181.55 96.55 196.5 111.5 189.7 140.65 183.65 168.35 146 172.7 152.5 178.7 152.55 185.9 L 152.55 218.15 Q 152.84 224.56 159.15 223.3 \n    159.21 223.3 159.25 223.3 181.14 216.25 198.7 198.7 228 169.4 228 128 228 86.6 198.7 57.3 169.4 28 128 28 86.6 28 57.3 57.3 28 86.6 28 128 28 169.4 57.3 198.7 74.85 \n    216.25 96.75 223.3 96.78 223.3 96.8 223.3 103.16 224.54 103.45 218.15 L 103.45 200 Q 82.97 203.1 75.1 196.35 69.85 191.65 68.4 185.45 64.27 177.055 59.4 174.15 49.20 \n    166.87 60.8 167.8 69.85 169.61 75.7 180 81.13 188.09 90 188.55 98.18 188.86 103.45 185.9 103.49 178.67 110 172.7 72.33 168.33 66.3 140.65 59.48 111.49 74.45 96.55 69.7 \n    82.41 75.5 70 84.87 68.74 103.15 80 115.125 76.635 128 76.85 140.85 76.65 152.85 80 171.1 68.75 180.5 70 Z\n    ",logo_neo:"\n    M 219 52 L 206 52 206 166 Q 206 183.4 193.75 195.65 181.4 208 164 208 146.6 208 134.35 195.65 122 183.4 122 166 L 122 90 Q 122 77.6 113.15 68.85 104.4 60 92 60 79.55 \n    60 70.75 68.85 62 77.6 62 90 L 62 204 75 204 75 90 Q 75 83 79.95 78 84.95 73 92 73 99 73 104 78 109 83 109 90 L 109 166 Q 109 188.8 125.15 204.85 141.2 221 164 221 \n    186.75 221 202.95 204.85 219 188.8 219 166 L 219 52 M 194 52 L 181 52 181 166 Q 181 173 176.05 178 171.05 183 164 183 157 183 152 178 147 173 147 166 L 147 90 Q 147 \n    67.2 130.85 51.15 114.8 35 92 35 69.25 35 53.05 51.15 37 67.2 37 90 L 37 204 50 204 50 90 Q 50 72.6 62.25 60.35 74.6 48 92 48 109.4 48 121.65 60.35 134 72.6 134 90 L \n    134 166 Q 134 178.4 142.85 187.15 151.6 196 164 196 176.45 196 185.25 187.15 194 178.4 194 166 L 194 52 Z\n    ",logo_phy:"\n    M 103.55 37.95 L 127.95 37.95 Q 162.35 37.95 186.5 55 210.9 72.35 210.9 96.5 210.9 120.65 186.5 137.7 162.35 155 127.95 155 L 127.95 237.95 M 127.95 155 \n    Q 93.55 155 69.15 137.7 45 120.65 45 96.5 45 72.35 69.15 55 70.9 53.8 72.85 52.85 M 127.95 155 L 127.95 37.95\n    ",logo_config:"\n    M 204.35 51.65 L 173.25 82.75 Q 192 101.5 192 128 L 236 128 M 192 128 Q 192 154.55 173.25 173.25 L 204.4 204.4 M 51.65 51.65 L 82.75 82.75 Q 101.5 64 128 64 \n    L 128 20 M 51.6 204.4 L 82.75 173.25 Q 64 154.55 64 128 L 20 128 M 128 236 L 128 192 Q 101.5 192 82.75 173.25 M 64 128 Q 64 101.5 82.75 82.75 M 173.25 173.25 \n    Q 154.55 192 128 192 M 128 64 Q 154.55 64 173.25 82.75\n    ",logo_donate:"\n    M 171.3 80.3 Q 179.5 62.15 171.3 45.8 164.1 32.5 141.35 30.1 L 94.35 30.1 Q 89.35 30.4 88.3 35.15 L 70.5 148.05 Q 70.2 152.5 73.7 152.6 L 100.95 152.6 107 111.6 Q 108.75 \n    106.55 112.6 106.45 130.45 108.05 145.3 103.9 163.35 98.75 171.3 80.3 M 179.8 71.5 Q 178.6 79.75 174.9 87.85 168.45 102.9 151.9 109.15 140.65 113.95 117.55 113 113.15 \n    112.75 111 117.45 L 102.7 169.95 Q 102.45 173.8 105.5 173.85 L 128.95 173.85 Q 132.2 174.2 133.35 169.65 L 138.3 139.95 Q 139.75 135.6 143.1 135.5 146.6 135.75 150.6 135.65 \n    154.55 135.5 157.35 135.1 160.15 134.7 166.75 132.35 181.35 127.4 187.9 111.2 194.25 95.75 189.5 81.95 186.75 74.85 179.8 71.5 M 103.5 209.9 Q 103.5 202.85 99.7 198.85 95.95 \n    194.75 89.4 194.75 82.8 194.75 79.05 198.85 75.3 202.9 75.3 209.9 75.3 216.85 79.05 220.95 82.8 225.05 89.4 225.05 95.95 225.05 99.7 221 103.5 216.95 103.5 209.9 M 95.45 205.5 \n    Q 95.95 207.3 95.95 209.9 95.95 212.65 95.45 214.35 94.95 216 94 217.3 93.1 218.45 91.9 219 90.7 219.55 89.4 219.55 88.15 219.55 86.95 219.05 85.75 218.55 84.8 217.3 83.9 216.15 \n    83.4 214.35 82.85 212.6 82.85 209.9 82.85 207.3 83.4 205.45 83.95 203.55 84.85 202.45 85.9 201.2 86.95 200.75 88.05 200.25 89.4 200.25 90.7 200.25 91.85 200.8 93.05 201.3 94 202.5 \n    94.9 203.65 95.45 205.5 M 153.3 195.35 L 145.3 195.35 135.5 224.45 142.8 224.45 144.6 218.5 153.75 218.5 155.6 224.45 163.1 224.45 153.3 195.35 M 152.15 213.25 L 146.25 213.25 \n    149.2 203.65 152.15 213.25 M 116.75 195.35 L 107.8 195.35 107.8 224.45 114.5 224.45 114.5 204.2 125.7 224.45 132.75 224.45 132.75 195.35 126.05 195.35 126.05 212.05 116.75 195.35 M \n    66.5 197.65 Q 64.15 196.15 61.45 195.75 58.8 195.35 55.75 195.35 L 46.7 195.35 46.7 224.45 55.8 224.45 Q 58.8 224.45 61.5 224.05 64.15 223.6 66.4 222.15 69.15 220.45 70.9 217.2 \n    72.7 214 72.7 209.95 72.7 205.7 71 202.6 69.35 199.5 66.5 197.65 M 64.2 205 Q 65.2 207 65.2 209.9 65.2 212.75 64.25 214.75 63.3 216.75 61.5 217.85 60 218.85 58.3 218.9 56.6 219 \n    54.15 219 L 54 219 54 200.8 54.15 200.8 Q 56.4 200.8 58.05 200.9 59.7 200.95 61.15 201.75 63.2 202.95 64.2 205 M 210.2 195.35 L 190.5 195.35 190.5 224.45 210.2 224.45 210.2 218.9 \n    197.75 218.9 197.75 211.55 209.2 211.55 209.2 206 197.75 206 197.75 200.9 210.2 200.9 210.2 195.35 M 187.5 195.35 L 163 195.35 163 200.9 171.6 200.9 171.6 224.45 178.9 224.45 178.9 \n    200.9 187.5 200.9 187.5 195.35 Z\n    "};O.setText();const B=O;class D{static autoTypes(e){let t=[];switch(e){case"svg":t=[{accept:{"image/svg+xml":".svg"}}];break;case"wav":t=[{accept:{"audio/wav":".wav"}}];break;case"mp3":t=[{accept:{"audio/mpeg":".mp3"}}];break;case"mp4":t=[{accept:{"video/mp4":".mp4"}}];break;case"bin":case"hex":t=[{description:"Binary Files",accept:{"application/octet-stream":[".bin",".hex"]}}];break;case"text":t=[{description:"Text Files",accept:{"text/plain":[".txt",".text"],"text/html":[".html",".htm"]}}];break;case"json":t=[{description:"JSON Files",accept:{"application/json":[".json"]}}];break;case"js":t=[{description:"JavaScript Files",accept:{"text/javascript":[".js"]}}];break;case"image":t=[{description:"Images",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}];break;case"icon":t=[{description:"Icons",accept:{"image/x-ico":[".ico"]}}];break;case"lut":t=[{description:"Lut",accept:{"text/plain":[".cube",".3dl"]}}]}return t}static async load(e={}){"function"!=typeof window.showOpenFilePicker&&(window.showOpenFilePicker=D.showOpenFilePickerPolyfill);try{let t=e.type||"";const n={excludeAcceptAllOption:!!t,multiple:!1};n.types=D.autoTypes(t);const a=await window.showOpenFilePicker(n),i=await a[0].getFile();if(!i)return null;let r=i.name,o=r.substring(r.lastIndexOf(".")+1,r.length);const s=["png","jpg","jpeg","mp4","webm","ogg","mp3"],l=["sea","z","hex","bvh","BVH","glb","gltf"],c=new FileReader;-1!==s.indexOf(o)?c.readAsDataURL(i):-1!==l.indexOf(o)?c.readAsArrayBuffer(i):c.readAsText(i),c.onload=function(n){let a=n.target.result;switch(t){case"image":let t=new Image;t.onload=function(){e.callback&&e.callback(t,r,o)},t.src=a;break;case"json":e.callback&&e.callback(JSON.parse(a),r,o);break;default:e.callback&&e.callback(a,r,o)}}}catch(t){console.log(t),e.always&&e.callback&&e.callback(null)}}static showOpenFilePickerPolyfill(e){return new Promise((t=>{const n=document.createElement("input");n.type="file",n.multiple=e.multiple,n.accept=e.types.map((e=>e.accept)).flatMap((e=>Object.keys(e).flatMap((t=>e[t])))).join(","),n.addEventListener("change",(()=>{t([...n.files].map((e=>({getFile:async()=>new Promise((t=>{t(e)}))}))))})),n.click()}))}static async save(e={}){let t=!1;"function"!=typeof window.showSaveFilePicker&&(window.showSaveFilePicker=D.showSaveFilePickerPolyfill,t=!0);try{let n=e.type||"";const a={suggestedName:e.name||"hello",data:e.data||""};a.types=D.autoTypes(n),a.finalType=Object.keys(a.types[0].accept)[0],a.suggestedName+=a.types[0].accept[a.finalType][0];const i=await window.showSaveFilePicker(a);if(t)return;const r=await i.createWritable();let o=new Blob([a.data],{type:a.finalType});await r.write(o),await r.close()}catch(e){console.log(e)}}static showSaveFilePickerPolyfill(e){return new Promise((t=>{const n=document.createElement("a");n.download=e.suggestedName||"my-file.txt";let a=new Blob([e.data],{type:e.finalType});n.href=URL.createObjectURL(a),n.addEventListener("click",(()=>{t(setTimeout((()=>URL.revokeObjectURL(n.href)),1e3))})),n.click()}))}static async getFolder(){try{const e=await window.showDirectoryPicker(),t=[];for await(const n of e.values()){const e=await n.getFile();t.push(e)}return console.log(t),t}catch(e){console.log(e)}}}var N="Consolas, Menlo, Courier, monospace",j="\n  .codeflask {\n    -o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select: none;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n  }\n\n  .codeflask, .codeflask * {\n    box-sizing: border-box;\n    border: none;\n    resize: none;\n    outline: none;\n  }\n\n  .codeflask__pre {\n    -o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select: none; pointer-events:none;\n    z-index: 3;\n    transform:translate3d(0, 0, 0);\n    box-sizing: border-box;\n    //white-space: pre;\n    padding:0px;\n    word-wrap: normal;\n    box-sizing: border-box;\n    border: none;\n    resize: none;\n    outline: none;\n    overflow: visible; !important;\n  }\n\n  .codeflask__textarea {\n\n    background: none;\n    //background:red;\n    border: none;\n    color: "+(function(e,t){return"undefined"!=typeof CSS?CSS.supports(e,t):"undefined"!=typeof document&&function(e){return(e=e.split("-").filter((function(e){return!!e})).map((function(e){return e[0].toUpperCase()+e.substr(1)})).join(""))[0].toLowerCase()+e.substr(1)}(e)in document.body.style}("caret-color","#F00")?"#282923":"#ccc")+";\n    color: rgba(0, 0, 0, 0);\n    z-index: 1;\n    resize: none;\n    //font-family: "+N+";\n    //text-rendering: optimizeSpeed;\n    //text-rendering: inherit;\n    //-webkit-appearance: pre;\n    caret-color: #fff;\n    z-index: 2;\n    width: 100%;\n    height: 100%;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box;\n\n    border: none;\n    outline: none;\n    spellcheck:false;\n    //overflow: hidden;\n    overflow: scroll !important;\n\n  }\n\n  .codeflask--has-line-numbers .codeflask__textarea {\n    width: calc(100% - 40px);\n  }\n\n  .codeflask__code {\n    //padding: 10px;\n    //background:black;\n    display:block;\n    font-size: 15px;\n    line-height: 19px;\n    font-family: "+N+";\n    //overflow: hidden;\n    //overflow: scroll !important;\n    //left:3px;\n    //width: auto;\n    //position: absolute;\n    outline: none;\n    resize: none;\n    box-sizing: content-box;\n    display: inline-block;\n  }\n\n  .codeflask__flatten {\n\n    //background:grey;\n    padding: 10px;\n    font-size: 15px;\n    line-height: 19px;\n    font-family: "+N+";\n    text-rendering: optimizeLegibility;\n    //letter-spacing: 1px;\n    white-space: pre;\n    word-wrap: normal;\n    box-sizing: border-box;\n    position: absolute;\n    top: 0;\n    left: 0;\n    margin: 0 !important;\n    outline: none;\n    text-align: left;\n    cursor:auto;\n    outline: none;\n    border-radius: 0;\n    border-width: 0;\n    background: transparent;\n    //-webkit-background-clip: padding-box;\n    background-clip: padding-box;\n    resize: none;\n\n  }\n\n  .codeflask--has-line-numbers .codeflask__flatten {\n    width: calc(100% - 40px);\n    left: 40px;\n    outline: none;\n  }\n\n  .codeflask__line-highlight {\n    position: absolute;\n    top: 10px;\n    left: 0;\n    width: 100%;\n    height: 19px;\n    background: rgba(0,0,0,0.1);\n\n    z-index: 1;\n    //visibility: hidden;\n    outline: none;\n  }\n\n  .codeflask__lines {\n    padding: 10px 4px;\n    font-size:  15px;\n    line-height: 19px;\n    font-family: "+N+";\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 40px;\n    height: 100%;\n    text-align: right;\n    color: #90918b;\n    z-index: 2;\n    outline: none;\n  }\n\n  .codeflask__lines__line {\n    display: block;\n    outline: none;\n  }\n\n  .codeflask.codeflask--has-line-numbers {\n    padding-left: 40px;\n  }\n\n  .codeflask.codeflask--has-line-numbers:before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 40px;\n    height: 100%;\n    //background: #282923;\n    z-index: 1;\n    outline: none;\n  }\n\n  .codeflask__error {\n    padding: 0px 0px;\n    padding-right:4px;\n    font-size:  15px;\n    font-family: "+N+";\n    position: absolute;\n    left: 0;\n    width: 40px;\n    height: 19px;\n    text-align: right;\n    color: #FF0000;\n    background:rgba(255,0,0,0.3);\n    outline: none;\n    z-index: 3;\n    display:none;\n  }\n";function Z(e,t,n){var a=t||"codeflask-style",i=n||document.head;if(!e)return!1;if(document.getElementById(a))return!0;var r=document.createElement("style");return r.innerHTML=e,r.id=a,i.appendChild(r),!0}var G={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Q(e){return String(e).replace(/[&<>"'`=/]/g,(function(e){return G[e]}))}var W=function(e){var t=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,n=0,a={},i={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function e(t){return t instanceof r?new r(t.type,e(t.content),t.alias):Array.isArray(t)?t.map(e):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++n}),e.__id},clone:function e(t,n){var a,r;switch(n=n||{},i.util.type(t)){case"Object":if(r=i.util.objId(t),n[r])return n[r];for(var o in a={},n[r]=a,t)t.hasOwnProperty(o)&&(a[o]=e(t[o],n));return a;case"Array":return r=i.util.objId(t),n[r]?n[r]:(a=[],n[r]=a,t.forEach((function(t,i){a[i]=e(t,n)})),a);default:return t}},getLanguage:function(e){for(;e;){var n=t.exec(e.className);if(n)return n[1].toLowerCase();e=e.parentElement}return"none"},setLanguage:function(e,n){e.className=e.className.replace(RegExp(t,"gi"),""),e.classList.add("language-"+n)},currentScript:function(){if("undefined"==typeof document)return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(a){var e=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(a.stack)||[])[1];if(e){var t=document.getElementsByTagName("script");for(var n in t)if(t[n].src==e)return t[n]}return null}},isActive:function(e,t,n){for(var a="no-"+t;e;){var i=e.classList;if(i.contains(t))return!0;if(i.contains(a))return!1;e=e.parentElement}return!!n}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(e,t){var n=i.util.clone(i.languages[e]);for(var a in t)n[a]=t[a];return n},insertBefore:function(e,t,n,a){var r=(a=a||i.languages)[e],o={};for(var s in r)if(r.hasOwnProperty(s)){if(s==t)for(var l in n)n.hasOwnProperty(l)&&(o[l]=n[l]);n.hasOwnProperty(s)||(o[s]=r[s])}var c=a[e];return a[e]=o,i.languages.DFS(i.languages,(function(t,n){n===c&&t!=e&&(this[t]=o)})),o},DFS:function e(t,n,a,r){r=r||{};var o=i.util.objId;for(var s in t)if(t.hasOwnProperty(s)){n.call(t,s,t[s],a||s);var l=t[s],c=i.util.type(l);"Object"!==c||r[o(l)]?"Array"!==c||r[o(l)]||(r[o(l)]=!0,e(l,n,s,r)):(r[o(l)]=!0,e(l,n,null,r))}}},plugins:{},highlightAll:function(e,t){i.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,n){var a={callback:n,container:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",a),a.elements=Array.prototype.slice.apply(a.container.querySelectorAll(a.selector)),i.hooks.run("before-all-elements-highlight",a);for(var r,o=0;r=a.elements[o++];)i.highlightElement(r,!0===t,a.callback)},highlightElement:function(t,n,a){var r=i.util.getLanguage(t),o=i.languages[r];i.util.setLanguage(t,r);var s=t.parentElement;s&&"pre"===s.nodeName.toLowerCase()&&i.util.setLanguage(s,r);var l={element:t,language:r,grammar:o,code:t.textContent};function c(e){l.highlightedCode=e,i.hooks.run("before-insert",l),l.element.innerHTML=l.highlightedCode,i.hooks.run("after-highlight",l),i.hooks.run("complete",l),a&&a.call(l.element)}if(i.hooks.run("before-sanity-check",l),(s=l.element.parentElement)&&"pre"===s.nodeName.toLowerCase()&&!s.hasAttribute("tabindex")&&s.setAttribute("tabindex","0"),!l.code)return i.hooks.run("complete",l),void(a&&a.call(l.element));if(i.hooks.run("before-highlight",l),l.grammar)if(n&&e.Worker){var d=new Worker(i.filename);d.onmessage=function(e){c(e.data)},d.postMessage(JSON.stringify({language:l.language,code:l.code,immediateClose:!0}))}else c(i.highlight(l.code,l.grammar,l.language));else c(i.util.encode(l.code))},highlight:function(e,t,n){var a={code:e,grammar:t,language:n};if(i.hooks.run("before-tokenize",a),!a.grammar)throw new Error('The language "'+a.language+'" has no grammar.');return a.tokens=i.tokenize(a.code,a.grammar),i.hooks.run("after-tokenize",a),r.stringify(i.util.encode(a.tokens),a.language)},tokenize:function(e,t){var n=t.rest;if(n){for(var a in n)t[a]=n[a];delete t.rest}var c=new function(){var e={value:null,prev:null,next:null},t={value:null,prev:e,next:null};e.next=t,this.head=e,this.tail=t,this.length=0};return s(c,c.head,e),function e(t,n,a,c,d,u){for(var p in a)if(a.hasOwnProperty(p)&&a[p]){var h=a[p];h=Array.isArray(h)?h:[h];for(var f=0;f<h.length;++f){if(u&&u.cause==p+","+f)return;var g=h[f],m=g.inside,b=!!g.lookbehind,k=!!g.greedy,v=g.alias;if(k&&!g.pattern.global){var y=g.pattern.toString().match(/[imsuy]*$/)[0];g.pattern=RegExp(g.pattern.source,y+"g")}for(var x=g.pattern||g,w=c.next,S=d;w!==n.tail&&!(u&&S>=u.reach);S+=w.value.length,w=w.next){var T=w.value;if(n.length>t.length)return;if(!(T instanceof r)){var L,C=1;if(k){if(!(L=o(x,S,t,b))||L.index>=t.length)break;var A=L.index,M=L.index+L[0].length,E=S;for(E+=w.value.length;A>=E;)E+=(w=w.next).value.length;if(S=E-=w.value.length,w.value instanceof r)continue;for(var z=w;z!==n.tail&&(E<M||"string"==typeof z.value);z=z.next)C++,E+=z.value.length;C--,T=t.slice(S,E),L.index-=S}else if(!(L=o(x,0,T,b)))continue;A=L.index;var F=L[0],P=T.slice(0,A),R=T.slice(A+F.length),I=S+T.length;u&&I>u.reach&&(u.reach=I);var _=w.prev;if(P&&(_=s(n,_,P),S+=P.length),l(n,_,C),w=s(n,_,new r(p,m?i.tokenize(F,m):F,v,F)),R&&s(n,w,R),C>1){var O={cause:p+","+f,reach:I};e(t,n,a,w.prev,S,O),u&&O.reach>u.reach&&(u.reach=O.reach)}}}}}}(e,c,t,c.head,0),function(e){for(var t=[],n=e.head.next;n!==e.tail;)t.push(n.value),n=n.next;return t}(c)},hooks:{all:{},add:function(e,t){var n=i.hooks.all;n[e]=n[e]||[],n[e].push(t)},run:function(e,t){var n=i.hooks.all[e];if(n&&n.length)for(var a,r=0;a=n[r++];)a(t)}},Token:r};function r(e,t,n,a){this.type=e,this.content=t,this.alias=n,this.length=0|(a||"").length}function o(e,t,n,a){e.lastIndex=t;var i=e.exec(n);if(i&&a&&i[1]){var r=i[1].length;i.index+=r,i[0]=i[0].slice(r)}return i}function s(e,t,n){var a=t.next,i={value:n,prev:t,next:a};return t.next=i,a.prev=i,e.length++,i}function l(e,t,n){for(var a=t.next,i=0;i<n&&a!==e.tail;i++)a=a.next;t.next=a,a.prev=t,e.length-=i}if(e.Prism=i,r.stringify=function e(t,n){if("string"==typeof t)return t;if(Array.isArray(t)){var a="";return t.forEach((function(t){a+=e(t,n)})),a}var r={type:t.type,content:e(t.content,n),tag:"span",classes:["token",t.type],attributes:{},language:n},o=t.alias;o&&(Array.isArray(o)?Array.prototype.push.apply(r.classes,o):r.classes.push(o)),i.hooks.run("wrap",r);var s="";for(var l in r.attributes)s+=" "+l+'="'+(r.attributes[l]||"").replace(/"/g,"&quot;")+'"';return"<"+r.tag+' class="'+r.classes.join(" ")+'"'+s+">"+r.content+"</"+r.tag+">"},!e.document)return e.addEventListener?(i.disableWorkerMessageHandler||e.addEventListener("message",(function(t){var n=JSON.parse(t.data),a=n.language,r=n.code,o=n.immediateClose;e.postMessage(i.highlight(r,i.languages[a],a)),o&&e.close()}),!1),i):i;var c=i.util.currentScript();function d(){i.manual||i.highlightAll()}if(c&&(i.filename=c.src,c.hasAttribute("data-manual")&&(i.manual=!0)),!i.manual){var u=document.readyState;"loading"===u||"interactive"===u&&c&&c.defer?document.addEventListener("DOMContentLoaded",d):window.requestAnimationFrame?window.requestAnimationFrame(d):window.setTimeout(d,16)}return i}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{});"undefined"!=typeof module&&module.exports&&(module.exports=W),"undefined"!=typeof global&&(global.Prism=W),W.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},W.languages.markup.tag.inside["attr-value"].inside.entity=W.languages.markup.entity,W.languages.markup.doctype.inside["internal-subset"].inside=W.languages.markup,W.hooks.add("wrap",(function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))})),Object.defineProperty(W.languages.markup.tag,"addInlined",{value:function(e,t){var n={};n["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:W.languages[t]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var a={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};a["language-"+t]={pattern:/[\s\S]+/,inside:W.languages[t]};var i={};i[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,(function(){return e})),"i"),lookbehind:!0,greedy:!0,inside:a},W.languages.insertBefore("markup","cdata",i)}}),Object.defineProperty(W.languages.markup.tag,"addAttribute",{value:function(e,t){W.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:W.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),W.languages.html=W.languages.markup,W.languages.mathml=W.languages.markup,W.languages.svg=W.languages.markup,W.languages.xml=W.languages.extend("markup",{}),W.languages.ssml=W.languages.xml,W.languages.atom=W.languages.xml,W.languages.rss=W.languages.xml,function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var n=e.languages.markup;n&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css"))}(W),W.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},W.languages.javascript=W.languages.extend("clike",{"class-name":[W.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|window|document|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|of|package|private|protected|public|return|static|super|switch|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+/NaN|Infinity|null/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?/}),W.languages.javascript["class-name"][0].pattern=/(\b(?:class|interface|extends|implements|instanceof|new|)\s+)[\w.\\]+/,W.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:W.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},"function-extra":{pattern:/(?:constructor)/,alias:"keyword"},"keyword-variable":{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|continue|debugger|default|delete|do|else|enum|export|default|extends|for|from|(?:get|set)(?=\s*[\[$\w\xA0-\uFFFF])|if|implements|import|in|instanceof|interface|new|of|package|private|protected|public|return|static|super|switch|throw|try|typeof|undefined|void|while|with|yield)\b/,alias:"keyword"},"parameter-variable":{pattern:/this/,alias:"keyword"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:W.languages.javascript},{pattern:/(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,inside:W.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:W.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:W.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),W.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:W.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),W.languages.markup&&(W.languages.markup.tag.addInlined("script","javascript"),W.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),W.languages.js=W.languages.javascript,W.languages.c=W.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/}),W.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}}),W.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},W.languages.c.string],char:W.languages.c.char,comment:W.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:W.languages.c}}}}),W.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/}),delete W.languages.c.boolean,W.languages.glsl=W.languages.extend("c",{keyword:/\b(?:active|asm|atomic_uint|attribute|[ibdu]?vec[234]|bool|break|buffer|case|cast|centroid|class|coherent|common|const|continue|d?mat[234](?:x[234])?|default|discard|do|double|else|enum|extern|external|false|filter|fixed|flat|float|for|fvec[234]|goto|half|highp|hvec[234]|[iu]?sampler2DMS(?:Array)?|[iu]?sampler2DRect|[iu]?samplerBuffer|[iu]?samplerCube|[iu]?samplerCubeArray|[iu]?sampler[123]D|[iu]?sampler[12]DArray|[iu]?image2DMS(?:Array)?|[iu]?image2DRect|[iu]?imageBuffer|[iu]?imageCube|[iu]?imageCubeArray|[iu]?image[123]D|[iu]?image[12]DArray|if|in|inline|inout|input|int|interface|invariant|layout|long|lowp|mediump|namespace|noinline|noperspective|out|output|partition|patch|precise|precision|public|readonly|resource|restrict|return|sample|sampler[12]DArrayShadow|sampler[12]DShadow|sampler2DRectShadow|sampler3DRect|samplerCubeArrayShadow|samplerCubeShadow|shared|short|sizeof|smooth|static|struct|subroutine|superp|switch|template|this|true|typedef|uint|uniform|union|unsigned|using|varying|void|volatile|while|writeonly)\b/});var q=function(e,t){if(!e)throw Error("CodeFlask expects a parameter which is Element or a String selector");if(!t)throw Error("CodeFlask expects an object containing options as second parameter");if(e.nodeType)this.editorRoot=e;else{var n=document.querySelector(e);n&&(this.editorRoot=n)}this.opts=t,this.startEditor()};q.prototype.clear=function(){this.elPre.removeChild(this.elCode),this.opts.lineNumbers&&this.elWrapper.removeChild(this.elLineNumbers),this.elWrapper.removeChild(this.elPre),this.elWrapper.removeChild(this.elTextarea),this.editorRoot.removeChild(this.elWrapper),this.code="",this.editorRoot.innerHTML=""},q.prototype.startEditor=function(){if(!Z(j,null,this.opts.styleParent))throw Error("Failed to inject CodeFlask CSS.");this.isEdit=!1,this.createWrapper(),this.createTextarea(),this.createPre(),this.createCode(),this.runOptions(),this.listenTextarea(),this.populateDefault(),this.updateCode(this.code)},q.prototype.getDom=function(){return this.elWrapper},q.prototype.getText=function(){return this.elTextarea},q.prototype.createWrapper=function(){this.code=this.editorRoot.innerHTML,this.editorRoot.innerHTML="",this.elWrapper=this.createElement("div",this.editorRoot),this.elWrapper.classList.add("codeflask")},q.prototype.createTextarea=function(){this.elTextarea=this.createElement("textarea",this.elWrapper),this.elTextarea.classList.add("codeflask__textarea","codeflask__flatten")},q.prototype.createPre=function(){this.elPre=this.createElement("pre",this.elWrapper),this.elPre.classList.add("codeflask__pre","codeflask__flatten")},q.prototype.createCode=function(){this.elCode=this.createElement("code",this.elPre),this.elCode.classList.add("codeflask__code","language-"+(this.opts.language||"html"))},q.prototype.createLineNumbers=function(){this.elLineNumbers=this.createElement("div",this.elWrapper),this.elLineNumbers.classList.add("codeflask__lines"),this.setLineNumber()},q.prototype.createError=function(){this.elError=this.createElement("div",this.elWrapper),this.elError.classList.add("codeflask__error")},q.prototype.createElement=function(e,t){var n=document.createElement(e);return t.appendChild(n),n},q.prototype.runOptions=function(){this.opts.rtl=this.opts.rtl||!1,this.opts.tabSize=this.opts.tabSize||4,this.opts.enableAutocorrect=this.opts.enableAutocorrect||!1,this.opts.lineNumbers=this.opts.lineNumbers||!1,this.opts.defaultTheme=!1!==this.opts.defaultTheme,this.opts.areaId=this.opts.areaId||null,this.opts.ariaLabelledby=this.opts.ariaLabelledby||null,this.opts.readonly=this.opts.readonly||null,"boolean"!=typeof this.opts.handleTabs&&(this.opts.handleTabs=!0),"boolean"!=typeof this.opts.handleSelfClosingCharacters&&(this.opts.handleSelfClosingCharacters=!0),"boolean"!=typeof this.opts.handleNewLineIndentation&&(this.opts.handleNewLineIndentation=!0),!0===this.opts.rtl&&(this.elTextarea.setAttribute("dir","rtl"),this.elPre.setAttribute("dir","rtl")),!1===this.opts.enableAutocorrect&&(this.elTextarea.setAttribute("spellcheck","false"),this.elTextarea.setAttribute("autocapitalize","off"),this.elTextarea.setAttribute("autocomplete","off"),this.elTextarea.setAttribute("autocorrect","off")),this.opts.lineNumbers&&(this.elWrapper.classList.add("codeflask--has-line-numbers"),this.createLineNumbers(),this.createError()),this.opts.defaultTheme&&Z("\n.codeflask {\n  background: #282923;\n  //color: rgba(0, 0, 0, 0);\n  color: #f8f8f2;\n  //border-radius: 12px;\n  //text-shadow: 1px 1px 1px black;\n  //resize: true;\n}\n\n.codeflask ::-webkit-scrollbar {\n  width: 15px;\n  height:15px;\n}\n\n.codeflask ::-webkit-scrollbar-track {\n  background:none;\n  /*background-clip: content-box;*/\n  \n}\n\n.codeflask ::-webkit-scrollbar-thumb {\n  background-color: #555652; \n  width: 7px;\n  //border-radius: 12px;\n  border: 4px solid #282923;\n}\n\n.codeflask ::-webkit-scrollbar-corner {\n  background-color: rgba(0,0,0,0);\n}\n\n\n\n.codeflask ::selection {\n  color: transparent;\n  background-color: #47473d; //rgba(71, 71, 61, 0.5);\n}\n\n.codeflask ::-moz-selection{\n  color: transparent;\n  background-color: #47473d; //rgba(71, 71, 61, 0.5);\n}\n\n\n.codeflask .token.punctuation { color: #f8f8f2; /* white */ }\n\n.codeflask .token.function { color: #67d8ef; /* blue */ } \n.codeflask .token.keyword { color: #67d8ef; font-style: italic; /* blue */ }\n\n.codeflask .token.function-variable { color: #a6e22c; /* green */ }\n.codeflask .token.class-name { color: #a6e22c; /* green */ }\n.codeflask .token.function-extra { color: #a6e22c; /* green */ }\n\n.codeflask .token.keyword-variable { color: #f92672; font-style: normal; /* red */ }\n.codeflask .token.operator { color: #f92672; /* red */ }\n\n.codeflask .token.parameter { color: #fd9621;/* orange */}\n.codeflask .token.parameter-variable { color: #fd9621;/* orange */}\n\n.codeflask .token.string { color: #e7db75; /* yellow */ }\n\n.codeflask .token.comment { color: #75715e; /* grey */ }\n\n\n\n.codeflask .token.boolean { color: #ae81ff; /* purple */ }\n.codeflask .token.number { color: #ae81ff; /* purple */ }\n\n.codeflask .token-template-string { color: #000000; }\n.codeflask .token-class-name { color: #000000; }\n.codeflask .token-regex { color: #000000; }\n\n.codeflask .token.selector { color: #00FF00; }\n.codeflask .token.property { color: #ac80ff;}\n.codeflask .token.tag { color: #FFFF00; }\n.codeflask .token.attr-value { color: #0000FF;}\n\n","theme-default",this.opts.styleParent),this.opts.areaId&&this.elTextarea.setAttribute("id",this.opts.areaId),this.opts.ariaLabelledby&&this.elTextarea.setAttribute("aria-labelledby",this.opts.ariaLabelledby),this.opts.readonly&&this.enableReadonlyMode()},q.prototype.updateLineNumbersCount=function(){for(var e="",t=1;t<=this.lineNumber;t++)e=e+'<span class="codeflask__lines__line">'+t+"</span>";this.elLineNumbers.innerHTML=e},q.prototype.listenTextarea=function(){var e=this;this.elTextarea.addEventListener("input",(function(t){e.code=t.target.value,e.elCode.innerHTML=Q(t.target.value),e.highlight(),setTimeout((function(){e.runUpdate(),e.setLineNumber()}),1)})),this.elTextarea.addEventListener("keydown",(function(t){e.opts.readonly||(e.handleTabs(t),e.handleSelfClosingCharacters(t),e.handleNewLineIndentation(t),e.isEdit=!0)})),this.elTextarea.addEventListener("scroll",(function(t){e.scroll(t)}))},q.prototype.wheel=function(e){var t=e.deltaY>0?1:-1;this.elTextarea.scrollTop+=100*t,this.elPre.style.transform="translate3d(0, -"+this.elTextarea.scrollTop+"px, 0)",this.elLineNumbers&&(this.elLineNumbers.style.transform="translate3d(0, -"+this.elTextarea.scrollTop+"px, 0)"),this.elError&&(this.elError.style.transform="translate3d(0, -"+this.elTextarea.scrollTop+"px, 0)")},q.prototype.scroll=function(e){this.elPre.style.transform="translate3d(-"+e.target.scrollLeft+"px, -"+e.target.scrollTop+"px, 0)",this.elLineNumbers&&(this.elLineNumbers.style.transform="translate3d(-"+this.elTextarea.scrollLeft+"px, -"+e.target.scrollTop+"px, 0)"),this.elError&&(this.elError.style.transform="translate3d(-"+this.elTextarea.scrollLeft+"px, -"+e.target.scrollTop+"px, 0)")},q.prototype.handleTabs=function(e){if(this.opts.handleTabs){if(9!==e.keyCode)return!1;e.preventDefault();var t=this.elTextarea,n=t.selectionDirection,a=t.selectionStart,i=t.selectionEnd,r=t.value,o=r.substr(0,a),s=r.substring(a,i),l=r.substring(i),c=" ".repeat(this.opts.tabSize);if(a!==i&&s.length>=c.length){var d=a-o.split("\n").pop().length,u=c.length,p=c.length;e.shiftKey?(r.substr(d,c.length)===c?(u=-u,d>a?(s=s.substring(0,d)+s.substring(d+c.length),p=0):d===a?(u=0,p=0,s=s.substring(c.length)):(p=-p,o=o.substring(0,d)+o.substring(d+c.length))):(u=0,p=0),s=s.replace(new RegExp("\n"+c.split("").join("\\"),"g"),"\n")):(o=o.substr(0,d)+c+o.substring(d,a),s=s.replace(/\n/g,"\n"+c)),t.value=o+s+l,t.selectionStart=a+u,t.selectionEnd=a+s.length+p,t.selectionDirection=n}else t.value=o+c+l,t.selectionStart=a+c.length,t.selectionEnd=a+c.length;var h=t.value;this.updateCode(h),this.elTextarea.selectionEnd=i+this.opts.tabSize}return!0},q.prototype.handleSelfClosingCharacters=function(e){if(this.opts.handleSelfClosingCharacters){var t=e.key;if(!["(","[","{","<","'",'"'].includes(t)&&![")","]","}",">","'",'"'].includes(t))return!1;switch(t){case"(":case")":this.closeCharacter(t);break;case"[":case"]":this.closeCharacter(t);break;case"{":case"}":this.closeCharacter(t);break;case"<":case">":case"'":case'"':this.closeCharacter(t)}return!0}},q.prototype.setLineNumber=function(){this.lineNumber=this.code.split("\n").length,this.opts.lineNumbers&&this.updateLineNumbersCount()},q.prototype.handleNewLineIndentation=function(e){if(!this.opts.handleNewLineIndentation)return!1;if(13!==e.keyCode)return!1;e.preventDefault();var t=this.elTextarea,n=t.selectionStart,a=t.selectionEnd,i=t.value,r=i.substr(0,n),o=i.substring(a),s=i.lastIndexOf("\n",n-1),l=s+i.slice(s+1).search(/[^ ]|$/),c=l>s?l-s:0,d=r+"\n"+" ".repeat(c)+o;return t.value=d,t.selectionStart=n+c+1,t.selectionEnd=n+c+1,this.updateCode(t.value),!0},q.prototype.closeCharacter=function(e){var t=this.elTextarea.selectionStart,n=this.elTextarea.selectionEnd;if(this.skipCloseChar(e)){var a=this.code.substr(n,1)===e,i=a?n+1:n,r=!a&&["'",'"'].includes(e)?e:"",o=""+this.code.substring(0,t)+r+this.code.substring(i);this.updateCode(o),this.elTextarea.selectionEnd=++this.elTextarea.selectionStart}else{var s=e;switch(e){case"(":s=String.fromCharCode(e.charCodeAt()+1);break;case"<":case"{":case"[":s=String.fromCharCode(e.charCodeAt()+2)}var l=this.code.substring(t,n),c=""+this.code.substring(0,t)+l+s+this.code.substring(n);this.updateCode(c)}this.elTextarea.selectionEnd=t},q.prototype.skipCloseChar=function(e){var t=this.elTextarea.selectionStart,n=this.elTextarea.selectionEnd,a=Math.abs(n-t)>0;return[")","}","]",">"].includes(e)||["'",'"'].includes(e)&&!a},q.prototype.updateCode=function(e){this.isEdit=!1,this.code=e,this.elTextarea.value=e,this.elCode.innerHTML=Q(e),this.highlight(),this.setLineNumber(),setTimeout(this.runUpdate.bind(this),1)},q.prototype.updateLanguage=function(e){var t=this.opts.language;this.elCode.classList.remove("language-"+t),this.elCode.classList.add("language-"+e),this.opts.language=e,this.highlight()},q.prototype.addLanguage=function(e,t){W.languages[e]=t},q.prototype.populateDefault=function(){this.updateCode(this.code)},q.prototype.highlight=function(){W.highlightElement(this.elCode,!1)},q.prototype.onUpdate=function(e){if(e&&"[object Function]"!=={}.toString.call(e))throw Error("CodeFlask expects callback of type Function");this.updateCallBack=e},q.prototype.getCode=function(){return this.code},q.prototype.runUpdate=function(){this.updateCallBack&&this.updateCallBack(this.code)},q.prototype.enableReadonlyMode=function(){this.elTextarea.setAttribute("readonly",!0)},q.prototype.disableReadonlyMode=function(){this.elTextarea.removeAttribute("readonly")},q.prototype.noError=function(){this.elError&&(this.elError.innerHTML="",this.elError.style.display="none")},q.prototype.addError=function(e,t,n){this.elError&&(this.elError.style.display="block",this.elError.innerHTML=t,this.elError.style.marginTop=19*t-9+"px")};class J{constructor(){this.init()}init(){this.codeName="",this.content=document.createElement("div"),this.content.style.cssText="font-size:12px; font-family:'Roboto Mono', 'Source Code Pro', Consolas, monospace; color:#f8f8f2; position:absolute; margin:0; padding:0; top:30px; right:10px; width:calc( 40% - 20px); height:calc( 100% - 60px); border: 1px solid #888882; opacity: 0.4;",this.code=new q(this.content,{language:"json",handleTabs:!0,lineNumbers:!1}),this.code.onUpdate(this.update.bind(this)),this.code.addLanguage("json",U),this.title=document.createElement("div"),this.title.style.cssText="-o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select: none; pointer-events:none;position:absolute; top:-28px; left:10px; width:calc( 40% - 20px); color:#7c806c; font-size:18px;",this.content.appendChild(this.title),document.body.appendChild(this.content)}update(){let e=this.validate(this.code.getCode());this.content.style.borderColor=e?"#888882":"#FF4036",this.title.style.color=e?"#f8f8f2":"#FF4036",e&&this.onChange(e)}onChange(){}set(e,t){this.codeName=t,this.title.innerHTML="&#x2022;&#160;"+this.codeName,this.code.updateCode(e)}direct(e,t){const n=t.substring(0,t.lastIndexOf("."));"string"==typeof e?this.set(e,n):this.set(JSON.stringify(json),n)}load(e){const t=e.substring(e.lastIndexOf("/")+1,e.lastIndexOf("."));var n=new XMLHttpRequest;n.open("GET",e),n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status?this.set(n.responseText,t):console.error("Couldn't load ["+t+"] ["+n.status+"]"))}.bind(this),setTimeout((function(){n.send()}),1)}loadFolder(){D.load({callback:function(e,t){this.direct(e,t)}.bind(this)})}save(e){D.save({name:this.codeName,data:this.code.getCode(),type:"json"})}validate(e){if(""===e)return!1;let t=!1;try{t=JSON.parse(e)}catch(e){return!1}return t}}const U={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};export{R as Smoke,J as SmokeEditor};
